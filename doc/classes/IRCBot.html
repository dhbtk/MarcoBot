<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: IRCBot</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">IRCBot</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../files/marcobot_rb.html">
                marcobot.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                Object
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
The One True Class, contains all of the methods here
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000021">autoop</a>&nbsp;&nbsp;
      <a href="#M000022">check_for_admin_command</a>&nbsp;&nbsp;
      <a href="#M000023">check_for_command</a>&nbsp;&nbsp;
      <a href="#M000030">check_trivia_answer</a>&nbsp;&nbsp;
      <a href="#M000026">coinflip</a>&nbsp;&nbsp;
      <a href="#M000004">connect</a>&nbsp;&nbsp;
      <a href="#M000027">decide</a>&nbsp;&nbsp;
      <a href="#M000024">dieroll</a>&nbsp;&nbsp;
      <a href="#M000005">disconnect</a>&nbsp;&nbsp;
      <a href="#M000025">eightball</a>&nbsp;&nbsp;
      <a href="#M000018">emote</a>&nbsp;&nbsp;
      <a href="#M000012">handle_invite</a>&nbsp;&nbsp;
      <a href="#M000014">handle_kick</a>&nbsp;&nbsp;
      <a href="#M000011">handle_message</a>&nbsp;&nbsp;
      <a href="#M000008">handle_queue</a>&nbsp;&nbsp;
      <a href="#M000006">handle_server_input</a>&nbsp;&nbsp;
      <a href="#M000013">handle_topic</a>&nbsp;&nbsp;
      <a href="#M000020">is_auth_user?</a>&nbsp;&nbsp;
      <a href="#M000019">log</a>&nbsp;&nbsp;
      <a href="#M000007">main_loop</a>&nbsp;&nbsp;
      <a href="#M000002">new</a>&nbsp;&nbsp;
      <a href="#M000016">privmsg</a>&nbsp;&nbsp;
      <a href="#M000009">rawlog</a>&nbsp;&nbsp;
      <a href="#M000003">send</a>&nbsp;&nbsp;
      <a href="#M000017">send_message</a>&nbsp;&nbsp;
      <a href="#M000015">startup_routine</a>&nbsp;&nbsp;
      <a href="#M000010">timestamp</a>&nbsp;&nbsp;
      <a href="#M000028">trivia_init</a>&nbsp;&nbsp;
      <a href="#M000029">trivia_question</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->
    <div id="includes">
      <h3 class="section-bar">Included Modules</h3>

      <div id="includes-list">
        <span class="include-name"><a href="Faidio.html">Faidio</a></span>
        <span class="include-name"><a href="Wiki.html">Wiki</a></span>
        <span class="include-name"><a href="Macros.html">Macros</a></span>
        <span class="include-name"><a href="Karma.html">Karma</a></span>
        <span class="include-name"><a href="Calc.html">Calc</a></span>
        <span class="include-name"><a href="Lyrics.html">Lyrics</a></span>
        <span class="include-name"><a href="Debugging.html">Debugging</a></span>
        <span class="include-name"><a href="Truco.html">Truco</a></span>
        <span class="include-name"><a href="Urbandict.html">Urbandict</a></span>
      </div>
    </div>

    <div id="section">





    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">configfile</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">karmafile</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">logarray</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">rawlogfile</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000002" class="method-detail">
        <a name="M000002"></a>

        <div class="method-heading">
          <a href="#M000002" class="method-signature">
          <span class="method-name">new</span><span class="method-args">(server,port,nick,autojoin_channels,ns_password,basepath,configfile,rcpath)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
initialize: get these nasty vars and make them globals.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000002-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000002-source">
<pre>
<span class="ruby-comment cmt"># File marcobot.rb, line 39</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">server</span>,<span class="ruby-identifier">port</span>,<span class="ruby-identifier">nick</span>,<span class="ruby-identifier">autojoin_channels</span>,<span class="ruby-identifier">ns_password</span>,<span class="ruby-identifier">basepath</span>,<span class="ruby-identifier">configfile</span>,<span class="ruby-identifier">rcpath</span>)
                <span class="ruby-ivar">@debug</span> = <span class="ruby-value str">&quot;&quot;</span>
                <span class="ruby-ivar">@rcpath</span> = <span class="ruby-identifier">rcpath</span>
                <span class="ruby-ivar">@server</span> = <span class="ruby-identifier">configfile</span>[<span class="ruby-value str">'server'</span>].<span class="ruby-identifier">strip</span>
                <span class="ruby-ivar">@port</span> = <span class="ruby-identifier">configfile</span>[<span class="ruby-value str">'port'</span>]
                <span class="ruby-ivar">@nick</span> = <span class="ruby-identifier">configfile</span>[<span class="ruby-value str">'nick'</span>].<span class="ruby-identifier">strip</span>
                <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">configfile</span>[<span class="ruby-value str">'debugmode'</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">'yes'</span> <span class="ruby-keyword kw">then</span>
                        <span class="ruby-ivar">@channel</span> = [<span class="ruby-identifier">configfile</span>[<span class="ruby-value str">'debugchannel'</span>].<span class="ruby-identifier">downcase</span>]
                <span class="ruby-keyword kw">else</span>
                        <span class="ruby-ivar">@channel</span> = <span class="ruby-identifier">autojoin_channels</span>.<span class="ruby-identifier">downcase</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;,&quot;</span>)
                <span class="ruby-keyword kw">end</span>
                <span class="ruby-identifier">puts</span> <span class="ruby-ivar">@channel</span>
                <span class="ruby-ivar">@ns_password</span> = <span class="ruby-identifier">configfile</span>[<span class="ruby-value str">'nickserv_password'</span>].<span class="ruby-identifier">strip</span>
                <span class="ruby-ivar">@basepath</span> = <span class="ruby-identifier">configfile</span>[<span class="ruby-value str">'basepath'</span>].<span class="ruby-identifier">strip</span>
                <span class="ruby-ivar">@command_identifier</span> = <span class="ruby-identifier">configfile</span>[<span class="ruby-value str">'commandidentifier'</span>].<span class="ruby-identifier">strip</span>
                <span class="ruby-ivar">@leavearray</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>
                <span class="ruby-ivar">@logarray</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>
                <span class="ruby-ivar">@voterarray</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>
                <span class="ruby-ivar">@timeout</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">new</span>
                <span class="ruby-ivar">@macrotime</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>
                <span class="ruby-ivar">@macrofile</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-node">&quot;#{@basepath}macros&quot;</span>,<span class="ruby-value str">&quot;r&quot;</span>)
                <span class="ruby-ivar">@yamlmacros</span> = <span class="ruby-constant">YAML</span><span class="ruby-operator">::</span><span class="ruby-identifier">load</span>(<span class="ruby-ivar">@macrofile</span>)
                <span class="ruby-ivar">@configfile</span> = <span class="ruby-identifier">configfile</span>
                <span class="ruby-ivar">@message_queue</span> = []
                <span class="ruby-ivar">@users</span> = {} <span class="ruby-comment cmt"># Userlist</span>
                <span class="ruby-ivar">@rawusers</span> = {}
<span class="ruby-comment cmt">#               @blocking = false</span>
                <span class="ruby-identifier">karma_init</span>()
                <span class="ruby-ivar">@debugwindow</span> = <span class="ruby-keyword kw">nil</span>
                <span class="ruby-identifier">trivia_init</span>()
                <span class="ruby-ivar">@trivia_question</span> = {}
                <span class="ruby-ivar">@trivia_started</span> = {}
                <span class="ruby-ivar">@old_trivia_question</span> = {}
        <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000021" class="method-detail">
        <a name="M000021"></a>

        <div class="method-heading">
          <a href="#M000021" class="method-signature">
          <span class="method-name">autoop</span><span class="method-args">(chan,user)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000021-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000021-source">
<pre>
<span class="ruby-comment cmt"># File marcobot.rb, line 426</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">autoop</span>(<span class="ruby-identifier">chan</span>,<span class="ruby-identifier">user</span>)
                <span class="ruby-keyword kw">case</span> <span class="ruby-ivar">@configfile</span>[<span class="ruby-value str">'aclautoop'</span>]
                        <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'no'</span>
                                <span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;MODE #{chan} +o #{user}&quot;</span>)
                        <span class="ruby-keyword kw">else</span>
                                <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@configfile</span>[<span class="ruby-value str">'autoopaclnicks'</span>].<span class="ruby-identifier">downcase</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;,&quot;</span>).<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">user</span>) <span class="ruby-keyword kw">then</span>
                                        <span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;MODE #{chan} +o #{user}&quot;</span>)
                                <span class="ruby-keyword kw">end</span>
                <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000022" class="method-detail">
        <a name="M000022"></a>

        <div class="method-heading">
          <a href="#M000022" class="method-signature">
          <span class="method-name">check_for_admin_command</span><span class="method-args">(message,user)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
|&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;|
|HUMUNGUOUS COMMANDS LAY BEYOND|
|&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;|
</p>
<pre>
 Checks for ADMIN commands in messages. Format: !! password !!command params DEPRECATED
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000022-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000022-source">
<pre>
<span class="ruby-comment cmt"># File marcobot.rb, line 442</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">check_for_admin_command</span>(<span class="ruby-identifier">message</span>,<span class="ruby-identifier">user</span>)
                <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">message</span>.<span class="ruby-identifier">start_with?</span>(<span class="ruby-ivar">@configfile</span>[<span class="ruby-value str">'admincommandidentifier'</span>]) <span class="ruby-keyword kw">then</span>
                        <span class="ruby-identifier">message_split</span> = <span class="ruby-identifier">message</span>.<span class="ruby-identifier">split</span> <span class="ruby-comment cmt"># By spaces, the default</span>
                        <span class="ruby-identifier">command</span> = <span class="ruby-identifier">message_split</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">sub</span>(<span class="ruby-ivar">@configfile</span>[<span class="ruby-value str">'admincommandidentifier'</span>],<span class="ruby-value str">&quot;&quot;</span>)
                        <span class="ruby-identifier">password</span> = <span class="ruby-identifier">message_split</span>[<span class="ruby-value">1</span>]
                        <span class="ruby-comment cmt"># Params are slightly more complicated. We need to set message_split[0,1,2] to nil first, and then join the message via spaces, and then strip the first three spaces. IF there is a param.</span>
                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">message_split</span>[<span class="ruby-value">3</span>] <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">then</span>
                                <span class="ruby-identifier">message_split</span>[<span class="ruby-value">0</span>] = <span class="ruby-keyword kw">nil</span>
                                <span class="ruby-identifier">message_split</span>[<span class="ruby-value">1</span>] = <span class="ruby-keyword kw">nil</span>
                                <span class="ruby-identifier">message_split</span>[<span class="ruby-value">2</span>] = <span class="ruby-keyword kw">nil</span>
                                <span class="ruby-identifier">params</span> = <span class="ruby-identifier">message_split</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot; &quot;</span>)
                                <span class="ruby-identifier">params</span> = <span class="ruby-identifier">params</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-value str">&quot;   &quot;</span>,<span class="ruby-value str">&quot;&quot;</span>)
                        <span class="ruby-keyword kw">end</span>
                        <span class="ruby-comment cmt"># It is a command. Let's see...</span>
                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">password</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@configfile</span>[<span class="ruby-value str">'adminpassword'</span>] <span class="ruby-keyword kw">then</span>
                                <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">command</span>
                                        <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;die&quot;</span>
                                                <span class="ruby-identifier">disconnect</span>()
                                        <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;raw&quot;</span>
                                                <span class="ruby-identifier">send</span>(<span class="ruby-identifier">params</span>)
                                        <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;help&quot;</span>
                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">user</span>,<span class="ruby-value str">&quot;ADMIN commands: die, raw, help, join, part.&quot;</span>)
                                        <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;join&quot;</span>
                                                <span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;JOIN #{params}&quot;</span>)
                                        <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;part&quot;</span>
                                                <span class="ruby-ivar">@leavearray</span>[<span class="ruby-identifier">params</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-value str">&quot; &quot;</span>,<span class="ruby-value str">&quot;&quot;</span>)] = <span class="ruby-value">0</span>
                                                <span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;PART #{params}&quot;</span>)
                                        <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;nick&quot;</span>
                                                <span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;NICK #{params.strip}&quot;</span>)
                                <span class="ruby-keyword kw">end</span>
                        <span class="ruby-keyword kw">else</span>
                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">user</span>,<span class="ruby-value str">&quot;Wrong password.&quot;</span>)
                        <span class="ruby-keyword kw">end</span>
                <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000023" class="method-detail">
        <a name="M000023"></a>

        <div class="method-heading">
          <a href="#M000023" class="method-signature">
          <span class="method-name">check_for_command</span><span class="method-args">(message,target,user,usermask)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Checks for user-accessible commands.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000023-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000023-source">
<pre>
<span class="ruby-comment cmt"># File marcobot.rb, line 478</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">check_for_command</span>(<span class="ruby-identifier">message</span>,<span class="ruby-identifier">target</span>,<span class="ruby-identifier">user</span>,<span class="ruby-identifier">usermask</span>)
                <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">message</span>.<span class="ruby-identifier">start_with?</span>(<span class="ruby-ivar">@configfile</span>[<span class="ruby-value str">'commandidentifier'</span>]) <span class="ruby-keyword kw">then</span>
                        <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;Command found&quot;</span>
                        <span class="ruby-identifier">command</span> = <span class="ruby-identifier">message</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-ivar">@configfile</span>[<span class="ruby-value str">'commandidentifier'</span>],<span class="ruby-value str">&quot;&quot;</span>)
                        <span class="ruby-identifier">params</span> = <span class="ruby-identifier">command</span>
                        <span class="ruby-identifier">command</span> = <span class="ruby-identifier">command</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot; &quot;</span>)[<span class="ruby-value">0</span>]
                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-node">&quot;#{command} &quot;</span>) <span class="ruby-keyword kw">then</span>
                                <span class="ruby-identifier">params</span> = <span class="ruby-identifier">params</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-node">&quot;#{command} &quot;</span>,<span class="ruby-value str">&quot;&quot;</span>).<span class="ruby-identifier">strip</span>
                        <span class="ruby-keyword kw">else</span>
                                <span class="ruby-identifier">params</span> = <span class="ruby-keyword kw">nil</span>
                        <span class="ruby-keyword kw">end</span>
                        <span class="ruby-identifier">message_split</span> = <span class="ruby-identifier">message</span>.<span class="ruby-identifier">split</span>
??
                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">command</span>.<span class="ruby-identifier">start_with?</span>(<span class="ruby-value str">&quot;bot&quot;</span>) <span class="ruby-keyword kw">then</span>
                                <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;Recieving message from partner bot&quot;</span>
                                <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">command</span>
                                        <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;botprocessthis&quot;</span>
                                                <span class="ruby-identifier">handle_server_input</span>(<span class="ruby-identifier">params</span>,<span class="ruby-keyword kw">true</span>)
                                                <span class="ruby-ivar">@handlingcommand</span> = <span class="ruby-keyword kw">true</span>
                                        <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;botprocessed&quot;</span>
                                                <span class="ruby-identifier">send</span>(<span class="ruby-identifier">params</span>)              
                                <span class="ruby-keyword kw">end</span>         
                        <span class="ruby-keyword kw">else</span>
                        <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;Giving command&quot;</span>
                        <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">command</span>
                                
                                <span class="ruby-comment cmt"># Travesty pack</span>
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;botprocessthis&quot;</span>
                                        <span class="ruby-identifier">handle_server_input</span>(<span class="ruby-identifier">params</span>)
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;botprocessed&quot;</span>
                                        <span class="ruby-identifier">send</span>(<span class="ruby-identifier">params</span>)
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;urbandict&quot;</span>
                                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">then</span>
                                                <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword kw">do</span>
                                                        <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Leeme look that up for you...&quot;</span>)
                                                        <span class="ruby-identifier">definition</span> = <span class="ruby-identifier">urbandict_lookup</span>(<span class="ruby-identifier">params</span>)
                                                        <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">item</span> <span class="ruby-keyword kw">in</span> <span class="ruby-identifier">definition</span>
                                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-identifier">item</span>,<span class="ruby-value">2</span>)
                                                        <span class="ruby-keyword kw">end</span>
                                                <span class="ruby-keyword kw">end</span>
                                        <span class="ruby-keyword kw">else</span>
<span class="ruby-comment cmt">#                                               privmsg(target,&quot;What should I look up?&quot;)</span>
                                        <span class="ruby-keyword kw">end</span>
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;isdown&quot;</span>
                                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">then</span>
                                                <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;:&quot;</span>).<span class="ruby-identifier">count</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span> <span class="ruby-keyword kw">then</span>
                                                        <span class="ruby-identifier">port</span> = <span class="ruby-identifier">params</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;:&quot;</span>)[<span class="ruby-value">1</span>].<span class="ruby-identifier">strip</span>
                                                        <span class="ruby-identifier">server</span> = <span class="ruby-identifier">params</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;:&quot;</span>)[<span class="ruby-value">0</span>].<span class="ruby-identifier">strip</span>
                                                <span class="ruby-keyword kw">else</span>
                                                        <span class="ruby-identifier">server</span> = <span class="ruby-identifier">params</span>.<span class="ruby-identifier">strip</span>
                                                        <span class="ruby-identifier">port</span> = <span class="ruby-value str">'80'</span>
                                                <span class="ruby-keyword kw">end</span>
                                                <span class="ruby-keyword kw">begin</span>
                                                        <span class="ruby-identifier">timeout</span>(<span class="ruby-value">5</span>) <span class="ruby-keyword kw">do</span>
                                                                <span class="ruby-ivar">@sock</span> = <span class="ruby-constant">TCPSocket</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">server</span>,<span class="ruby-identifier">port</span>)
                                                        <span class="ruby-keyword kw">end</span>
                                                <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Exception</span>
                                                        <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Site is down!&quot;</span>)
                                                <span class="ruby-keyword kw">else</span>
                                                        <span class="ruby-ivar">@sock</span>.<span class="ruby-identifier">close</span>
                                                        <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;It's just you.&quot;</span>)
                                                <span class="ruby-keyword kw">end</span>
                                                <span class="ruby-ivar">@sock</span> = <span class="ruby-keyword kw">nil</span>
                                        <span class="ruby-keyword kw">else</span>
                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;I need a site to check.&quot;</span>)
                                        <span class="ruby-keyword kw">end</span>
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;addquestion&quot;</span>
                                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">params</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;&lt;is&gt;&quot;</span>).<span class="ruby-identifier">count</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">1</span> <span class="ruby-keyword kw">then</span>
                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-node">&quot;Usage: #{@configfile['commandidentifier']}addquestion Question?&lt;is&gt;Answer&quot;</span>)
                                        <span class="ruby-keyword kw">else</span>
                                                <span class="ruby-identifier">question</span> = <span class="ruby-identifier">params</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;&lt;is&gt;&quot;</span>)[<span class="ruby-value">0</span>]
                                                <span class="ruby-identifier">answer</span> = <span class="ruby-identifier">params</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-node">&quot;#{params.split(&quot;&lt;is&gt;&quot;)[0]}&lt;is&gt;&quot;</span>,<span class="ruby-value str">&quot;&quot;</span>)
                                                <span class="ruby-ivar">@trivia_questions</span>.<span class="ruby-identifier">push</span>(<span class="ruby-node">&quot;#{question}\n#{answer}&quot;</span>)
                                                <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-node">&quot;#{@basepath}trivia&quot;</span>,<span class="ruby-value str">&quot;w&quot;</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">file</span><span class="ruby-operator">|</span>
                                                        <span class="ruby-identifier">file</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-ivar">@trivia_questions</span>.<span class="ruby-identifier">to_yaml</span>
                                                <span class="ruby-keyword kw">end</span>
                                                <span class="ruby-identifier">trivia_init</span>()
                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Question added.&quot;</span>)
                                        <span class="ruby-keyword kw">end</span>
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;trivia&quot;</span>
                                        <span class="ruby-identifier">target</span> = <span class="ruby-identifier">target</span>.<span class="ruby-identifier">downcase</span>
                                        <span class="ruby-ivar">@old_trivia_question</span>[<span class="ruby-identifier">target</span>] = <span class="ruby-keyword kw">nil</span>
                                        <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@trivia_started</span>[<span class="ruby-identifier">target</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@trivia_started</span>[<span class="ruby-identifier">target</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">then</span>
                                                <span class="ruby-ivar">@trivia_started</span>[<span class="ruby-identifier">target</span>] = <span class="ruby-keyword kw">true</span>
                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Trivia started.&quot;</span>)
                                                <span class="ruby-identifier">trivia_question</span>(<span class="ruby-identifier">target</span>)
                                        <span class="ruby-keyword kw">else</span>
                                                <span class="ruby-ivar">@trivia_started</span>[<span class="ruby-identifier">target</span>] = <span class="ruby-keyword kw">false</span>
                                                <span class="ruby-ivar">@trivia_question</span>[<span class="ruby-identifier">target</span>.<span class="ruby-identifier">downcase</span>] = <span class="ruby-value str">&quot;&quot;</span>
                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Trivia has ended.&quot;</span>)
                                        <span class="ruby-keyword kw">end</span>
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;lyrics&quot;</span>
                                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">then</span>
                                                <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot; - &quot;</span>).<span class="ruby-identifier">count</span> <span class="ruby-operator">!=</span> <span class="ruby-value">2</span> <span class="ruby-keyword kw">then</span>
                                                        <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Wrong params or something&quot;</span>)
                                                <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">params</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^&quot;(.+?)&quot;\s-\s(.+?)/</span> <span class="ruby-keyword kw">then</span>
                                                        <span class="ruby-identifier">band</span> = <span class="ruby-identifier">params</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot; - &quot;</span>)[<span class="ruby-value">1</span>]
                                                        <span class="ruby-identifier">song</span> = <span class="ruby-identifier">params</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot; - &quot;</span>)[<span class="ruby-value">0</span>]                                                    
                                                        <span class="ruby-identifier">returning</span> = <span class="ruby-identifier">get_lyrics</span>(<span class="ruby-identifier">band</span>,<span class="ruby-identifier">song</span>)
                                                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">returning</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">==</span> <span class="ruby-constant">NilClass</span> <span class="ruby-keyword kw">then</span>
                                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Not found. Sorry.&quot;</span>)
                                                        <span class="ruby-keyword kw">else</span>
                                                                <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">i</span> <span class="ruby-keyword kw">in</span> <span class="ruby-identifier">returning</span>
                                                                        <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-identifier">i</span>)
                                                                <span class="ruby-keyword kw">end</span>
                                                        <span class="ruby-keyword kw">end</span>
                                                <span class="ruby-keyword kw">else</span>
                                                        <span class="ruby-identifier">band</span> = <span class="ruby-identifier">params</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot; - &quot;</span>)[<span class="ruby-value">0</span>]
                                                        <span class="ruby-identifier">song</span> = <span class="ruby-identifier">params</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot; - &quot;</span>)[<span class="ruby-value">1</span>]
                                                        <span class="ruby-identifier">returning</span> = <span class="ruby-identifier">get_lyrics</span>(<span class="ruby-identifier">band</span>,<span class="ruby-identifier">song</span>)
                                                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">returning</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">==</span> <span class="ruby-constant">NilClass</span> <span class="ruby-keyword kw">then</span>
                                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Not found. Sorry.&quot;</span>)
                                                        <span class="ruby-keyword kw">else</span>
                                                                <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">i</span> <span class="ruby-keyword kw">in</span> <span class="ruby-identifier">returning</span>
                                                                        <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-identifier">i</span>)
                                                                <span class="ruby-keyword kw">end</span>
                                                        <span class="ruby-keyword kw">end</span>
                                                <span class="ruby-keyword kw">end</span>
                                        <span class="ruby-keyword kw">else</span>
                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Usage: ~lyrics Band - Song&quot;</span>)
                                        <span class="ruby-keyword kw">end</span>
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;macrosave&quot;</span>
                                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">is_auth_user?</span>(<span class="ruby-identifier">usermask</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;@&quot;</span>)[<span class="ruby-value">0</span>]) <span class="ruby-keyword kw">then</span>
                                                <span class="ruby-identifier">macro_save</span>()
                                        <span class="ruby-keyword kw">end</span>
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;macrotrim&quot;</span>
                                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">is_auth_user?</span>(<span class="ruby-identifier">usermask</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;@&quot;</span>)[<span class="ruby-value">0</span>]) <span class="ruby-keyword kw">then</span>      
                                                <span class="ruby-identifier">macro_trim</span>()
                                        <span class="ruby-keyword kw">end</span>
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;calc&quot;</span>
                                        <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@configfile</span>[<span class="ruby-value str">'calcrestricted'</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">'true'</span> <span class="ruby-keyword kw">then</span>
                                                <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">is_auth_user?</span>(<span class="ruby-identifier">usermask</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;@&quot;</span>)[<span class="ruby-value">0</span>]) <span class="ruby-keyword kw">then</span>
                                                        <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-identifier">sanitize</span>(<span class="ruby-identifier">params</span>))
                                                <span class="ruby-keyword kw">else</span>
                                                        <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Calculator is restricted.&quot;</span>)
                                                <span class="ruby-keyword kw">end</span>
                                        <span class="ruby-keyword kw">else</span>
                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-identifier">sanitize</span>(<span class="ruby-identifier">params</span>))
                                        <span class="ruby-keyword kw">end</span>
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;autoop&quot;</span>
                                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">then</span>
                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-node">&quot;Usage: #{@configfile['commandidentifier']}oplist [add|remove|check] nick&quot;</span>)
                                        <span class="ruby-keyword kw">else</span>
                                                <span class="ruby-identifier">params_split</span> = <span class="ruby-identifier">params</span>.<span class="ruby-identifier">split</span>
                                                <span class="ruby-identifier">acl</span> = <span class="ruby-ivar">@configfile</span>[<span class="ruby-value str">'autoopaclnicks'</span>].<span class="ruby-identifier">downcase</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;,&quot;</span>)
                                                <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">params_split</span>[<span class="ruby-value">0</span>]
                                                        <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;add&quot;</span>
                                                                <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">acl</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">params_split</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">downcase</span>) <span class="ruby-keyword kw">then</span>
                                                                        <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;User is already in the ACL&quot;</span>)
                                                                <span class="ruby-keyword kw">else</span>
                                                                        <span class="ruby-identifier">acl</span>.<span class="ruby-identifier">push</span> <span class="ruby-identifier">params_split</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">downcase</span>
                                                                        <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;User has been added to the ACL&quot;</span>)
                                                                <span class="ruby-keyword kw">end</span>
                                                        <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;remove&quot;</span>
                                                                <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">acl</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">params_split</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">downcase</span>) <span class="ruby-keyword kw">then</span>
                                                                        <span class="ruby-identifier">acl</span>.<span class="ruby-identifier">delete</span> <span class="ruby-identifier">params_split</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">downcase</span>
                                                                        <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;User removed from the ACL&quot;</span>)
                                                                <span class="ruby-keyword kw">else</span>
                                                                        <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;User isn't in the ACL&quot;</span>)
                                                                <span class="ruby-keyword kw">end</span>
                                                        <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;check&quot;</span>
                                                                <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">acl</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">params_split</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">downcase</span>) <span class="ruby-keyword kw">then</span>
                                                                        <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;User is in the ACL&quot;</span>)
                                                                <span class="ruby-keyword kw">else</span>
                                                                        <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;User isn't in the ACL&quot;</span>)
                                                                <span class="ruby-keyword kw">end</span>
                                                <span class="ruby-keyword kw">end</span>
                                                <span class="ruby-identifier">acl</span> = <span class="ruby-identifier">acl</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;,&quot;</span>)
                                                <span class="ruby-identifier">acl</span> = <span class="ruby-identifier">acl</span>.<span class="ruby-identifier">downcase</span>
                                                <span class="ruby-ivar">@configfile</span>[<span class="ruby-value str">'autoopaclnicks'</span>] = <span class="ruby-identifier">acl</span>
                                        <span class="ruby-keyword kw">end</span>
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;viewconfig&quot;</span>
                                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">is_auth_user?</span>(<span class="ruby-identifier">usermask</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;@&quot;</span>)[<span class="ruby-value">0</span>]) <span class="ruby-keyword kw">then</span>
                                                <span class="ruby-identifier">stuff</span> = <span class="ruby-identifier">params</span>
                                                <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@configfile</span>[<span class="ruby-identifier">stuff</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">then</span>
                                                        <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-node">&quot;\&quot;#{stuff}\&quot; is nil&quot;</span>)
                                                <span class="ruby-keyword kw">elsif</span> <span class="ruby-operator">!</span><span class="ruby-identifier">stuff</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">&quot;password&quot;</span>) <span class="ruby-keyword kw">or</span> <span class="ruby-operator">!</span><span class="ruby-identifier">stuff</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">&quot;authnicks&quot;</span>) <span class="ruby-keyword kw">or</span> <span class="ruby-operator">!</span><span class="ruby-identifier">stuff</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">&quot;basepath&quot;</span>) <span class="ruby-keyword kw">then</span>
                                                        <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-node">&quot;\&quot;#{stuff}\&quot; is \&quot;#{@configfile[stuff]}\&quot;&quot;</span>)
                                                <span class="ruby-keyword kw">else</span>
                                                        <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">user</span>,<span class="ruby-node">&quot;\&quot;#{stuff}\&quot; is \&quot;#{@configfile[stuff]}\&quot;&quot;</span>)
                                                <span class="ruby-keyword kw">end</span>
                                        <span class="ruby-keyword kw">end</span>
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;karmareload&quot;</span>
                                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">is_auth_user?</span>(<span class="ruby-identifier">usermask</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;@&quot;</span>)[<span class="ruby-value">0</span>]) <span class="ruby-keyword kw">then</span>
                                                <span class="ruby-identifier">karma_save</span>
                                                <span class="ruby-identifier">karma_init</span>
                                        <span class="ruby-keyword kw">end</span>                                        
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;part&quot;</span>
                                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">is_auth_user?</span>(<span class="ruby-identifier">usermask</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;@&quot;</span>)[<span class="ruby-value">0</span>]) <span class="ruby-keyword kw">then</span>
                                                <span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;PART #{params.strip}&quot;</span>)
                                        <span class="ruby-keyword kw">end</span>
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;do&quot;</span>
                                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">is_auth_user?</span>(<span class="ruby-identifier">usermask</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;@&quot;</span>)[<span class="ruby-value">0</span>]) <span class="ruby-keyword kw">then</span>
                                                <span class="ruby-identifier">send</span>(<span class="ruby-identifier">params</span>.<span class="ruby-identifier">strip</span>)
                                        <span class="ruby-keyword kw">end</span>
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;join&quot;</span>
                                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">is_auth_user?</span>(<span class="ruby-identifier">usermask</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;@&quot;</span>)[<span class="ruby-value">0</span>]) <span class="ruby-keyword kw">then</span>
                                                <span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;JOIN #{params.strip}&quot;</span>)
                                        <span class="ruby-keyword kw">end</span>
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;help&quot;</span>
                                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">then</span>
                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-node">&quot;Commands: ~help, ~coinflip, ~8ball, ~leave, ~live, ~thetime, ~shutup, ~macro, ~wiki, ~urbandict, ~dieroll, ~echo, ~lyrics, ~faidio, ~faidwiki, ~stfu, ~karma, decision making, ~trivia, ~addquestion, ~isdown. Run \&quot;#{@configfile['commandidentifier']}help ~command\&quot; to get a more specific help.&quot;</span>)
<span class="ruby-comment cmt">#                                               privmsg(target,&quot;Commands: #{@configfile['commandidentifier']}catchphrase, #{@configfile['commandidentifier']}define, #{@configfile['commandidentifier']}die, #{@configfile['commandidentifier']}dieroll, #{@configfile['commandidentifier']}flingpoo, #{@configfile['commandidentifier']}isdown, #{@configfile['commandidentifier']}macro, #{@configfile['commandidentifier']}macrocheck, #{@configfile['commandidentifier']}oplist, #{@configfile['commandidentifier']}quote, #{@configfile['commandidentifier']}rae, #{@configfile['commandidentifier']}ratscrew, #{@configfile['commandidentifier']}spam, #{@configfile['commandidentifier']}swears, #{@configfile['commandidentifier']}timebomb, #{@configfile['commandidentifier']}trout, #{@configfile['commandidentifier']}urbandict, #{@configfile['commandidentifier']}unwiki, #{@configfile['commandidentifier']}wiki. Run #{@configfile['commandidentifier']}help &lt;#{@configfile['commandidentifier']}command&gt; for help.&quot;)</span>
                                        <span class="ruby-keyword kw">else</span>
                                                <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">params</span>
                                                        <span class="ruby-keyword kw">when</span> <span class="ruby-node">&quot;#{@configfile['commandidentifier']}lyrics&quot;</span>
                                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Check the lyrics for a song. Use like 'Band - Song' or '\&quot;Song\&quot; - Artist' (fuck you MoD)&quot;</span>)
                                                        <span class="ruby-keyword kw">when</span> <span class="ruby-node">&quot;#{@configfile['commandidentifier']}help&quot;</span>
                                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Usage: ~help ~command.&quot;</span>)
                                                        <span class="ruby-keyword kw">when</span> <span class="ruby-node">&quot;#{@configfile['commandidentifier']}coinflip&quot;</span>
                                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Flips a coin [citation needed] and shows the outcome. Can also be used as \&quot;ACTION flips a coin\&quot;&quot;</span>)
                                                        <span class="ruby-keyword kw">when</span> <span class="ruby-node">&quot;#{@configfile['commandidentifier']}8ball&quot;</span>
                                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Ask a question to the mighty 8-ball. \&quot;Should I?\&quot; questions are preferred.&quot;</span>)
                                                        <span class="ruby-keyword kw">when</span> <span class="ruby-node">&quot;#{@configfile['commandidentifier']}leave&quot;</span>
                                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Adds a vote for me to leave. Three votes = leave channel.&quot;</span>)
                                                        <span class="ruby-keyword kw">when</span> <span class="ruby-node">&quot;#{@configfile['commandidentifier']}live&quot;</span>
                                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Unvotes.&quot;</span>)
                                                        <span class="ruby-keyword kw">when</span> <span class="ruby-node">&quot;#{@configfile['commandidentifier']}thetime&quot;</span>
                                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Prints the local time.&quot;</span>)
                                                        <span class="ruby-keyword kw">when</span> <span class="ruby-node">&quot;#{@configfile['commandidentifier']}shutup&quot;</span>
                                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Toggles macros.&quot;</span>)
                                                        <span class="ruby-keyword kw">when</span> <span class="ruby-node">&quot;#{@configfile['commandidentifier']}macro&quot;</span>
                                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Sets macros. They must have more than five characters. Setting them to a space removes them. Usage: ~macro input phrase=output phrase&quot;</span>)
                                                        <span class="ruby-keyword kw">when</span> <span class="ruby-node">&quot;#{@configfile['commandidentifier']}wiki&quot;</span>
                                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-node">&quot;Usage: #{@configfile['commandidentifier']}wiki Article. Case-sensitive. Buggy as hell, use at your own risk.&quot;</span>)
                                                        <span class="ruby-keyword kw">when</span> <span class="ruby-node">&quot;#{@configfile['commandidentifier']}dieroll&quot;</span>
                                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-node">&quot;Usage: \&quot;#{@configfile['commandidentifier']}dieroll (one)d(two)\&quot; or \&quot; ACTION rolls (one)d(two)\&quot;. One must be smaller than 11, and two must be smaller than 20,000.&quot;</span>)
                                                        <span class="ruby-keyword kw">when</span> <span class="ruby-node">&quot;#{@configfile['commandidentifier']}faidio&quot;</span>
                                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Shows the FaiDio streams.&quot;</span>)
                                                        <span class="ruby-keyword kw">when</span> <span class="ruby-node">&quot;#{@configfile['commandidentifier']}stfu&quot;</span>
                                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Clears the message queue. Useful for spam-y situations.&quot;</span>)
                                                        <span class="ruby-keyword kw">when</span> <span class="ruby-node">&quot;#{@configfile['commandidentifier']}faidwiki&quot;</span>
                                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Looks up an article on the FaiDwiki.&quot;</span>)
                                                        <span class="ruby-keyword kw">when</span> <span class="ruby-node">&quot;#{@configfile['commandidentifier']}karma&quot;</span>
                                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Karma's a bitch.&quot;</span>)
                                                        <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;decision making&quot;</span>
                                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Ask me, with my username first, about something or other.&quot;</span>)
                                                        <span class="ruby-keyword kw">when</span> <span class="ruby-node">&quot;#{@configfile['commandidentifier']}trivia&quot;</span>
                                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Starts/ends trivia on the current channel.&quot;</span>)
                                                        <span class="ruby-keyword kw">when</span> <span class="ruby-node">&quot;#{@configfile['commandidentifier']}addquestion&quot;</span>
                                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Adds a question to the trivia question database. Usage: ~addquestion Question?&lt;is&gt;Answer&quot;</span>)
                                                        <span class="ruby-keyword kw">when</span> <span class="ruby-node">&quot;#{@configfile['commandidentifier']}isdown&quot;</span>
                                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-node">&quot;Checks if a site is down. Usage: #{@configfile['commandidentifier']}isdown site.com:optionalport&quot;</span>)
                                                        <span class="ruby-keyword kw">when</span> <span class="ruby-node">&quot;#{@configfile['commandidentifier']}urbandict&quot;</span>
                                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Looks up something at UrbanDictionary.com.&quot;</span>)
                                                        <span class="ruby-keyword kw">else</span>
                                                                <span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;NOTICE #{user} :No such command. Contradictions are lies.&quot;</span>)
                                                <span class="ruby-keyword kw">end</span>
                                        <span class="ruby-keyword kw">end</span>
??
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;coinflip&quot;</span>
                                        <span class="ruby-identifier">coinflip</span>(<span class="ruby-identifier">target</span>)
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;8ball&quot;</span>
                                        <span class="ruby-identifier">eightball</span>(<span class="ruby-identifier">target</span>)
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;leave&quot;</span>
                                        <span class="ruby-identifier">user</span> = <span class="ruby-identifier">usermask</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;!&quot;</span>)[<span class="ruby-value">1</span>]
                                         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">target</span>[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;#&quot;</span> <span class="ruby-keyword kw">then</span>
                                           <span class="ruby-ivar">@leavearray</span>[<span class="ruby-identifier">target</span>] = <span class="ruby-value">0</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@leavearray</span>[<span class="ruby-identifier">target</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span>
                                           <span class="ruby-ivar">@voterarray</span>[<span class="ruby-identifier">target</span>] = [] <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@voterarray</span>[<span class="ruby-identifier">target</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span>
                                           <span class="ruby-identifier">unvalidvoter</span> = <span class="ruby-keyword kw">false</span>
                                           <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">voter</span> <span class="ruby-keyword kw">in</span> <span class="ruby-ivar">@voterarray</span>[<span class="ruby-identifier">target</span>]
                                                   <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">user</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">voter</span> <span class="ruby-keyword kw">then</span>
                                                           <span class="ruby-identifier">unvalidvoter</span> = <span class="ruby-keyword kw">true</span>
                                                   <span class="ruby-keyword kw">end</span>
                                           <span class="ruby-keyword kw">end</span>
                                           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">unvalidvoter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">then</span>
                                                   <span class="ruby-ivar">@leavearray</span>[<span class="ruby-identifier">target</span>] = <span class="ruby-ivar">@leavearray</span>[<span class="ruby-identifier">target</span>] <span class="ruby-operator">+</span> <span class="ruby-value">1</span>
                                                   <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@leavearray</span>[<span class="ruby-identifier">target</span>] <span class="ruby-operator">&gt;=</span> <span class="ruby-value">3</span> <span class="ruby-keyword kw">then</span>
                                                           <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Six votes! I'm out&quot;</span>)
                                                           <span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;PART #{target}&quot;</span>)
                                                           <span class="ruby-ivar">@leavearray</span>[<span class="ruby-identifier">target</span>] = <span class="ruby-value">0</span>
                                                           <span class="ruby-ivar">@voterarray</span>[<span class="ruby-identifier">target</span>] = []
                                                   <span class="ruby-keyword kw">else</span>
                                                           <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-node">&quot;There are now #{@leavearray[target]} out of 3 votes for asking me to leave.&quot;</span>)
                                                           <span class="ruby-ivar">@voterarray</span>[<span class="ruby-identifier">target</span>].<span class="ruby-identifier">push</span> <span class="ruby-identifier">user</span>
                                                   <span class="ruby-keyword kw">end</span>
                                           <span class="ruby-keyword kw">else</span>
                                                   <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;You have already voted.&quot;</span>)
                                           <span class="ruby-keyword kw">end</span>
                                         <span class="ruby-keyword kw">else</span>
                                           <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;What the cruds are you trying to do?&quot;</span>)
                                         <span class="ruby-keyword kw">end</span>
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;live&quot;</span>
                                        <span class="ruby-identifier">user</span> = <span class="ruby-identifier">usermask</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;!&quot;</span>)[<span class="ruby-value">1</span>]
                                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">target</span>[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;#&quot;</span> <span class="ruby-keyword kw">then</span>
                                                <span class="ruby-ivar">@leavearray</span>[<span class="ruby-identifier">target</span>] = <span class="ruby-value">0</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@leavearray</span>[<span class="ruby-identifier">target</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span>
                                                <span class="ruby-ivar">@voterarray</span>[<span class="ruby-identifier">target</span>] = [] <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@voterarray</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span>
                                                <span class="ruby-identifier">validvoter</span> = <span class="ruby-keyword kw">false</span>
                                                <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">voter</span> <span class="ruby-keyword kw">in</span> <span class="ruby-ivar">@voterarray</span>[<span class="ruby-identifier">target</span>]
                                                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">voter</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">user</span> <span class="ruby-keyword kw">then</span>
                                                                <span class="ruby-identifier">validvoter</span> = <span class="ruby-keyword kw">true</span>
                                                        <span class="ruby-keyword kw">end</span>
                                                <span class="ruby-keyword kw">end</span>
                                                <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">validvoter</span> <span class="ruby-keyword kw">then</span>
                                                        <span class="ruby-ivar">@leavearray</span>[<span class="ruby-identifier">target</span>] <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>
                                                        <span class="ruby-ivar">@voterarray</span>[<span class="ruby-identifier">target</span>].<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">user</span>)
                                                        <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-node">&quot;Vote removed. #{@leavearray[target]} votes remaining.&quot;</span>)
                                                <span class="ruby-keyword kw">else</span>
                                                        <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;You haven't voted!&quot;</span>)
                                                <span class="ruby-keyword kw">end</span>
                                        <span class="ruby-keyword kw">else</span>
                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;What the cruds are you trying to do?&quot;</span>)
                                        <span class="ruby-keyword kw">end</span>
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;die&quot;</span>
                                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">is_auth_user?</span>(<span class="ruby-identifier">usermask</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;@&quot;</span>)[<span class="ruby-value">0</span>]) <span class="ruby-keyword kw">then</span>
                                                <span class="ruby-identifier">disconnect</span>(<span class="ruby-identifier">params</span>)
                                        <span class="ruby-keyword kw">else</span>
                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Sorry Dave, I can't let you do that.&quot;</span>)
                                        <span class="ruby-keyword kw">end</span>
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;time&quot;</span>
                                        <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-node">&quot;The correct, Brazilian, time is: #{Time.now}&quot;</span>)
<span class="ruby-comment cmt">#                                       privmsg(target,&quot;You're on a motherfucking computer. Just check.&quot;)</span>
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;macro&quot;</span>
                                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/(.+?)=(.+?)/</span> <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">params</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/(.+?)=$/</span> <span class="ruby-keyword kw">then</span>
                                                <span class="ruby-identifier">add_macro</span>(<span class="ruby-identifier">target</span>,<span class="ruby-identifier">params</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;=&quot;</span>)[<span class="ruby-value">0</span>],<span class="ruby-identifier">params</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-identifier">params</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;=&quot;</span>)[<span class="ruby-value">0</span>]<span class="ruby-operator">+</span><span class="ruby-value str">&quot;=&quot;</span>,<span class="ruby-value str">&quot;&quot;</span>))
                                        <span class="ruby-keyword kw">else</span>
                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Incorrect usage. RTFM.&quot;</span>)
                                        <span class="ruby-keyword kw">end</span>
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;macrocheck&quot;</span>
                                        <span class="ruby-identifier">macrocheck</span>(<span class="ruby-identifier">params</span>,<span class="ruby-identifier">target</span>)
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;shutup&quot;</span>
                                        <span class="ruby-keyword kw">case</span> <span class="ruby-ivar">@configfile</span>[<span class="ruby-value str">'macrosenabled'</span>]
                                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'true'</span>
                                                        <span class="ruby-ivar">@macros_enabled</span> = <span class="ruby-value str">'false'</span>
                                                        <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Macros were disabled.&quot;</span>)
                                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'false'</span>
                                                        <span class="ruby-ivar">@macros_enabled</span> = <span class="ruby-value str">'true'</span>
                                                        <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Macros were re-enabled.&quot;</span>)
                                        <span class="ruby-keyword kw">end</span>
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;wiki&quot;</span>
                                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">then</span>
<span class="ruby-comment cmt">#                                               privmsg(target,&quot;Wikiing, hold on...&quot;)</span>
                                                <span class="ruby-identifier">search_wiki</span>(<span class="ruby-identifier">target</span>,<span class="ruby-identifier">params</span>,<span class="ruby-value str">&quot;en.wikipedia.org&quot;</span>)
                                        <span class="ruby-keyword kw">else</span>
<span class="ruby-comment cmt">#                                               privmsg(target,&quot;Getting a random, hold on...&quot;)</span>
                                                <span class="ruby-identifier">find_wiki</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Special:Random&quot;</span>,<span class="ruby-identifier">user</span>)
                                        <span class="ruby-keyword kw">end</span>
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;faidwiki&quot;</span>
                                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">then</span>
<span class="ruby-comment cmt">#                                               privmsg(target,&quot;Wikiing, hold on...&quot;)</span>
                                                <span class="ruby-identifier">search_wiki</span>(<span class="ruby-identifier">target</span>,<span class="ruby-identifier">params</span>,<span class="ruby-value str">&quot;faidwiki.niexs.net&quot;</span>)
                                        <span class="ruby-keyword kw">else</span>
<span class="ruby-comment cmt">#                                               privmsg(target,&quot;Getting a random, hold on...&quot;)</span>
                                                <span class="ruby-identifier">find_faidwiki</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Special:Random&quot;</span>,<span class="ruby-identifier">user</span>)
                                        <span class="ruby-keyword kw">end</span>                                
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;oldwiki&quot;</span>
                                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">then</span>
                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Wikiing, hold on...&quot;</span>)
                                                <span class="ruby-identifier">find_wiki</span>(<span class="ruby-identifier">target</span>,<span class="ruby-identifier">params</span>,<span class="ruby-identifier">user</span>)
                                        <span class="ruby-keyword kw">else</span>
                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Getting a random, hold on...&quot;</span>)
                                                <span class="ruby-identifier">find_wiki</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Special:Random&quot;</span>,<span class="ruby-identifier">user</span>)
                                        <span class="ruby-keyword kw">end</span>
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;oldfaidwiki&quot;</span>
                                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">then</span>
                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Looking up...&quot;</span>)
                                                <span class="ruby-identifier">find_faidwiki</span>(<span class="ruby-identifier">target</span>,<span class="ruby-identifier">params</span>,<span class="ruby-identifier">user</span>)
                                        <span class="ruby-keyword kw">else</span>
                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Getting a random, hold on...&quot;</span>)
                                                <span class="ruby-identifier">find_faidwiki</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Special:Random&quot;</span>,<span class="ruby-identifier">user</span>)
                                        <span class="ruby-keyword kw">end</span>
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;dieroll&quot;</span>
                                        <span class="ruby-identifier">dieroll</span>(<span class="ruby-identifier">target</span>,<span class="ruby-identifier">params</span>)
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;echo&quot;</span>
                                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">then</span> 
                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-identifier">params</span>)
                                        <span class="ruby-keyword kw">else</span>
                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Echo what?&quot;</span>)
                                        <span class="ruby-keyword kw">end</span>
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;faidio&quot;</span>
                                        <span class="ruby-identifier">faidio</span>(<span class="ruby-identifier">target</span>)
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;reloadmacros&quot;</span>
                                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">is_auth_user?</span>(<span class="ruby-identifier">usermask</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;@&quot;</span>)[<span class="ruby-value">0</span>]) <span class="ruby-keyword kw">then</span>
                                                <span class="ruby-ivar">@macrofile</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-node">&quot;#{@basepath}macros&quot;</span>,<span class="ruby-value str">&quot;r&quot;</span>)
                                                <span class="ruby-ivar">@yamlmacros</span> = <span class="ruby-constant">YAML</span><span class="ruby-operator">::</span><span class="ruby-identifier">load</span>(<span class="ruby-ivar">@macrofile</span>)
                                                <span class="ruby-ivar">@macrofile</span>.<span class="ruby-identifier">rewind</span>
                                                <span class="ruby-ivar">@macros</span> = <span class="ruby-ivar">@macrofile</span>.<span class="ruby-identifier">readlines</span>
                                        <span class="ruby-keyword kw">else</span>
                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;I'm sorry Dave, I can't let you do that.&quot;</span>)
                                        <span class="ruby-keyword kw">end</span>
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;eval&quot;</span>
                                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">is_auth_user?</span>(<span class="ruby-identifier">usermask</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;@&quot;</span>)[<span class="ruby-value">0</span>]) <span class="ruby-keyword kw">then</span>
                                                <span class="ruby-identifier">eval</span>(<span class="ruby-identifier">params</span>)
                                        <span class="ruby-keyword kw">else</span>
                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;I'm sorry Dave, I can't let you do that.&quot;</span>)                                                
                                        <span class="ruby-keyword kw">end</span>
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;stfu&quot;</span>
                                        <span class="ruby-ivar">@message_queue</span>.<span class="ruby-identifier">clear</span>
                                        <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Outgoing message queue cleared.&quot;</span>,<span class="ruby-value">2</span>)
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;listconfig&quot;</span>
??
                                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">is_auth_user?</span>(<span class="ruby-identifier">usermask</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;@&quot;</span>)[<span class="ruby-value">0</span>]) <span class="ruby-keyword kw">then</span>
                                                <span class="ruby-identifier">configoptions</span> = []
                                                <span class="ruby-ivar">@configfile</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
                                                        <span class="ruby-identifier">configoptions</span>.<span class="ruby-identifier">push</span> <span class="ruby-identifier">f</span>[<span class="ruby-value">0</span>]
                                                <span class="ruby-keyword kw">end</span>
                                                <span class="ruby-identifier">configoptions</span>.<span class="ruby-identifier">sort!</span>
                                                <span class="ruby-identifier">configoptions</span> = <span class="ruby-identifier">configoptions</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;, &quot;</span>)
                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-node">&quot;My configurable options are: #{configoptions}&quot;</span>)
                                        <span class="ruby-keyword kw">else</span>
                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;I don't know you. Go away.&quot;</span>)
                                        <span class="ruby-keyword kw">end</span>
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;config&quot;</span>
                                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">is_auth_user?</span>(<span class="ruby-identifier">usermask</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;@&quot;</span>)[<span class="ruby-value">0</span>]) <span class="ruby-keyword kw">then</span>
                                                <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/(.+?)=&quot;(.+)&quot;/</span> <span class="ruby-keyword kw">then</span>
                                                        <span class="ruby-identifier">config</span> = <span class="ruby-identifier">params</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;=&quot;</span>)[<span class="ruby-value">0</span>]
                                                        <span class="ruby-identifier">config_params</span> = <span class="ruby-identifier">params</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-identifier">params</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;=&quot;</span>)[<span class="ruby-value">0</span>]<span class="ruby-operator">+</span><span class="ruby-value str">&quot;=&quot;</span>,<span class="ruby-value str">&quot;&quot;</span>)
                                                        <span class="ruby-identifier">config_params</span>[<span class="ruby-value">-1</span>] = <span class="ruby-value str">&quot;&quot;</span>
                                                        <span class="ruby-identifier">config_params</span>[<span class="ruby-value">0</span>] = <span class="ruby-value str">&quot;&quot;</span>
                                                        <span class="ruby-ivar">@configfile</span>[<span class="ruby-identifier">config</span>] = <span class="ruby-identifier">config_params</span>
                                                        <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-node">&quot;Config option \&quot;#{config}\&quot; has been set to \&quot;#{config_params}\&quot;.&quot;</span>)
                                                <span class="ruby-keyword kw">else</span>
                                                        <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Wrong&quot;</span>)
                                                <span class="ruby-keyword kw">end</span>
                                        <span class="ruby-keyword kw">else</span>
                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Can't do that man&quot;</span>)
                                        <span class="ruby-keyword kw">end</span>
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;saveconfig&quot;</span>
                                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">is_auth_user?</span>(<span class="ruby-identifier">usermask</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;@&quot;</span>)[<span class="ruby-value">0</span>]) <span class="ruby-keyword kw">then</span>
                                                <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-node">&quot;#{@rcpath}/marcobotrc&quot;</span>,<span class="ruby-value str">&quot;w&quot;</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
                                                        <span class="ruby-identifier">f</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-ivar">@configfile</span>.<span class="ruby-identifier">to_yaml</span>
                                                <span class="ruby-keyword kw">end</span>
                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Config file saved.&quot;</span>)
                                        <span class="ruby-keyword kw">else</span>
                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;You can't do that man&quot;</span>)
                                        <span class="ruby-keyword kw">end</span>
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;karma&quot;</span>
                                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">then</span>
                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">'Whose karma?'</span>)
                                        <span class="ruby-keyword kw">else</span>
                                                <span class="ruby-identifier">get_karma</span>(<span class="ruby-identifier">target</span>,<span class="ruby-identifier">params</span>.<span class="ruby-identifier">strip</span>)
                                        <span class="ruby-keyword kw">end</span>
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;userlist&quot;</span>
                                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">is_auth_user?</span>(<span class="ruby-identifier">usermask</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;@&quot;</span>)[<span class="ruby-value">0</span>]) <span class="ruby-keyword kw">then</span>
                                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-ivar">@users</span>[<span class="ruby-identifier">target</span>.<span class="ruby-identifier">downcase</span>].<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot; &quot;</span>))
                                        <span class="ruby-keyword kw">end</span>
                        <span class="ruby-keyword kw">end</span>
                        <span class="ruby-ivar">@handlingcommand</span> = <span class="ruby-keyword kw">false</span>
                        <span class="ruby-keyword kw">end</span>
                <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000030" class="method-detail">
        <a name="M000030"></a>

        <div class="method-heading">
          <a href="#M000030" class="method-signature">
          <span class="method-name">check_trivia_answer</span><span class="method-args">(target,answer,user)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000030-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000030-source">
<pre>
<span class="ruby-comment cmt"># File marcobot.rb, line 1060</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">check_trivia_answer</span>(<span class="ruby-identifier">target</span>,<span class="ruby-identifier">answer</span>,<span class="ruby-identifier">user</span>)
                <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@trivia_question</span>[<span class="ruby-identifier">target</span>.<span class="ruby-identifier">downcase</span>].<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>)[<span class="ruby-value">1</span>].<span class="ruby-identifier">downcase</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/(:|,|\.|\!|\?|;|'|&quot;)/</span>,<span class="ruby-value str">&quot;&quot;</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-value str">&quot; an &quot;</span>,<span class="ruby-value str">&quot;&quot;</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-value str">&quot; a &quot;</span>,<span class="ruby-value str">&quot;&quot;</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-value str">&quot; the &quot;</span>,<span class="ruby-value str">&quot;&quot;</span>).<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-value str">&quot; &quot;</span>,<span class="ruby-value str">&quot;&quot;</span>) <span class="ruby-operator">==</span> <span class="ruby-identifier">answer</span>.<span class="ruby-identifier">downcase</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/(:|,|\.|\!|\?|;|'|&quot;)/</span>,<span class="ruby-value str">&quot;&quot;</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-value str">&quot; an &quot;</span>,<span class="ruby-value str">&quot;&quot;</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-value str">&quot; a &quot;</span>,<span class="ruby-value str">&quot;&quot;</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-value str">&quot; the &quot;</span>,<span class="ruby-value str">&quot;&quot;</span>).<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-value str">&quot; &quot;</span>,<span class="ruby-value str">&quot;&quot;</span>)  <span class="ruby-keyword kw">then</span>
                        <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-node">&quot;Correct, #{user}!&quot;</span>)
                        <span class="ruby-identifier">trivia_question</span>(<span class="ruby-identifier">target</span>)
                <span class="ruby-keyword kw">else</span>
                        <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Wrong. Try harder.&quot;</span>)
                <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000026" class="method-detail">
        <a name="M000026"></a>

        <div class="method-heading">
          <a href="#M000026" class="method-signature">
          <span class="method-name">coinflip</span><span class="method-args">(target)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Flips a coin
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000026-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000026-source">
<pre>
<span class="ruby-comment cmt"># File marcobot.rb, line 1008</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">coinflip</span>(<span class="ruby-identifier">target</span>)
                <span class="ruby-identifier">i</span> = <span class="ruby-identifier">rand</span>(<span class="ruby-value">2</span>)
                <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">i</span>
                        <span class="ruby-keyword kw">when</span> <span class="ruby-value">0</span>
                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Heads.&quot;</span>)
                        <span class="ruby-keyword kw">when</span> <span class="ruby-value">1</span>
                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Tails.&quot;</span>)
                <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000004" class="method-detail">
        <a name="M000004"></a>

        <div class="method-heading">
          <a href="#M000004" class="method-signature">
          <span class="method-name">connect</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Connects to IRC
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000004-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000004-source">
<pre>
<span class="ruby-comment cmt"># File marcobot.rb, line 82</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">connect</span>()
                <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;Connecting...&quot;</span>
                <span class="ruby-ivar">@irc</span> = <span class="ruby-constant">TCPSocket</span>.<span class="ruby-identifier">open</span>(<span class="ruby-ivar">@server</span>,<span class="ruby-ivar">@port</span>)
                <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;Connected!&quot;</span>
                <span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;USER #{@configfile['username']} foo bar :#{@configfile['fullname']}&quot;</span>)
                <span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;NICK #{@configfile['nick']}&quot;</span>)
                <span class="ruby-ivar">@connected</span> = <span class="ruby-keyword kw">true</span>;
        <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000027" class="method-detail">
        <a name="M000027"></a>

        <div class="method-heading">
          <a href="#M000027" class="method-signature">
          <span class="method-name">decide</span><span class="method-args">(target,message)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Decides on stuff
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000027-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000027-source">
<pre>
<span class="ruby-comment cmt"># File marcobot.rb, line 1018</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">decide</span>(<span class="ruby-identifier">target</span>,<span class="ruby-identifier">message</span>)
                <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">message</span>[<span class="ruby-value">-1</span>].<span class="ruby-identifier">chr</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;?&quot;</span> <span class="ruby-keyword kw">then</span>
                        <span class="ruby-identifier">message</span>[<span class="ruby-value">-1</span>] = <span class="ruby-value str">&quot;&quot;</span>
                <span class="ruby-keyword kw">end</span>
                <span class="ruby-identifier">stuff</span> = <span class="ruby-identifier">message</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot; or &quot;</span>)
                <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">stuff</span>.<span class="ruby-identifier">count</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span> <span class="ruby-keyword kw">then</span>
                        <span class="ruby-identifier">eightball</span>(<span class="ruby-identifier">target</span>)
                <span class="ruby-keyword kw">else</span>
<span class="ruby-comment cmt">#                       count = rand(stuff.count + 1)</span>
<span class="ruby-comment cmt">#                       privmsg(target,stuff[count-1])</span>
                        <span class="ruby-identifier">choices</span> = []
                        <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">thing</span> <span class="ruby-keyword kw">in</span> <span class="ruby-identifier">stuff</span>
                                <span class="ruby-identifier">choices</span>.<span class="ruby-identifier">push</span> [<span class="ruby-identifier">thing</span>,<span class="ruby-constant">Digest</span><span class="ruby-operator">::</span><span class="ruby-constant">SHA1</span>.<span class="ruby-identifier">new</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">thing</span>.<span class="ruby-identifier">downcase</span>]
                        <span class="ruby-keyword kw">end</span>
                        <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-identifier">choices</span>.<span class="ruby-identifier">sort</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">x</span>,<span class="ruby-identifier">y</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">to_s</span> <span class="ruby-operator">&lt;=&gt;</span> <span class="ruby-identifier">y</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">to_s</span>}[<span class="ruby-value">0</span>][<span class="ruby-value">0</span>])
                <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000024" class="method-detail">
        <a name="M000024"></a>

        <div class="method-heading">
          <a href="#M000024" class="method-signature">
          <span class="method-name">dieroll</span><span class="method-args">(target,params)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Throws dice or something
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000024-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000024-source">
<pre>
<span class="ruby-comment cmt"># File marcobot.rb, line 960</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">dieroll</span>(<span class="ruby-identifier">target</span>,<span class="ruby-identifier">params</span>)
                <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">then</span>
                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>.<span class="ruby-identifier">strip</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^[0-9]+d[0-9]+$/</span> <span class="ruby-keyword kw">then</span>
                                <span class="ruby-identifier">dice_number</span> = <span class="ruby-identifier">params</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;d&quot;</span>)[<span class="ruby-value">0</span>].<span class="ruby-identifier">to_i</span>
                                <span class="ruby-identifier">side_number</span> = <span class="ruby-identifier">params</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;d&quot;</span>)[<span class="ruby-value">1</span>].<span class="ruby-identifier">sub</span>(<span class="ruby-value str">&quot;\n&quot;</span>,<span class="ruby-value str">&quot;&quot;</span>).<span class="ruby-identifier">to_i</span>
                                <span class="ruby-comment cmt"># Throwing the dice</span>
                                <span class="ruby-identifier">i</span> = <span class="ruby-value">0</span>
                                <span class="ruby-identifier">sum</span> = <span class="ruby-value">0</span>
                                <span class="ruby-identifier">resultarray</span> = []
                                <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">dice_number</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">10</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">side_number</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">20000</span> <span class="ruby-keyword kw">then</span>
                                <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">i</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">dice_number</span>
                                        <span class="ruby-identifier">i</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
                                        <span class="ruby-identifier">result</span> = <span class="ruby-identifier">rand</span>(<span class="ruby-identifier">side_number</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>) <span class="ruby-operator">+</span><span class="ruby-value">1</span>
                                        <span class="ruby-identifier">sum</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">result</span>
                                        <span class="ruby-identifier">resultarray</span>.<span class="ruby-identifier">push</span> <span class="ruby-identifier">result</span>
                                <span class="ruby-keyword kw">end</span>
                                <span class="ruby-keyword kw">end</span>
                                <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">sum</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">side_number</span> <span class="ruby-operator">&lt;</span><span class="ruby-value">3</span> <span class="ruby-keyword kw">then</span>
                                        <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;You fail at making plausible dice.&quot;</span>)
                                <span class="ruby-keyword kw">else</span>
                                        <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-identifier">resultarray</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;, &quot;</span>)<span class="ruby-operator">+</span><span class="ruby-value str">&quot;. Total: &quot;</span><span class="ruby-operator">+</span><span class="ruby-identifier">sum</span>.<span class="ruby-identifier">to_s</span>)
                                <span class="ruby-keyword kw">end</span>
                        <span class="ruby-keyword kw">else</span>
                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Usage: (one)d(two), one is the number of dice, and two is the number of sides.&quot;</span>)    <span class="ruby-keyword kw">end</span>
                <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000005" class="method-detail">
        <a name="M000005"></a>

        <div class="method-heading">
          <a href="#M000005" class="method-signature">
          <span class="method-name">disconnect</span><span class="method-args">(message = &quot;Farewell&quot;)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Disconnects from IRC
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000005-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000005-source">
<pre>
<span class="ruby-comment cmt"># File marcobot.rb, line 92</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">disconnect</span>(<span class="ruby-identifier">message</span> = <span class="ruby-value str">&quot;Farewell&quot;</span>)
                <span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;QUIT :#{message}&quot;</span>)
                <span class="ruby-ivar">@connected</span> = <span class="ruby-keyword kw">false</span>;
        <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000025" class="method-detail">
        <a name="M000025"></a>

        <div class="method-heading">
          <a href="#M000025" class="method-signature">
          <span class="method-name">eightball</span><span class="method-args">(target)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000025-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000025-source">
<pre>
<span class="ruby-comment cmt"># File marcobot.rb, line 986</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">eightball</span>(<span class="ruby-identifier">target</span>)
                <span class="ruby-identifier">i</span> = <span class="ruby-identifier">rand</span>(<span class="ruby-value">8</span>)
                <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">i</span> 
                        <span class="ruby-keyword kw">when</span> <span class="ruby-value">0</span>
                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Of course.&quot;</span>)
                        <span class="ruby-keyword kw">when</span> <span class="ruby-value">1</span>
                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Mmm, perhaps.&quot;</span>)
                        <span class="ruby-keyword kw">when</span> <span class="ruby-value">2</span>
                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;You shouldn't.&quot;</span>)
                        <span class="ruby-keyword kw">when</span> <span class="ruby-value">3</span>
                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Not really.&quot;</span>)
                        <span class="ruby-keyword kw">when</span> <span class="ruby-value">4</span>
                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;Don't or you will suffer.&quot;</span>)
                        <span class="ruby-keyword kw">when</span> <span class="ruby-value">5</span>
                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;You can't know for sure.&quot;</span>)
                        <span class="ruby-keyword kw">when</span> <span class="ruby-value">6</span>
                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;You totally should.&quot;</span>)
                        <span class="ruby-keyword kw">when</span> <span class="ruby-value">7</span>
                                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;YES! DO IT!&quot;</span>)
                <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000018" class="method-detail">
        <a name="M000018"></a>

        <div class="method-heading">
          <a href="#M000018" class="method-signature">
          <span class="method-name">emote</span><span class="method-args">(target,message)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="IRCBot.html#M000018">emote</a>: Because everyone loves /me
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000018-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000018-source">
<pre>
<span class="ruby-comment cmt"># File marcobot.rb, line 357</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">emote</span>(<span class="ruby-identifier">target</span>,<span class="ruby-identifier">message</span>)
                <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-node">&quot;ACTION #{message}&quot;</span>)
                <span class="ruby-identifier">log</span>(<span class="ruby-identifier">target</span>,<span class="ruby-ivar">@configfile</span>[<span class="ruby-value str">'nick'</span>],<span class="ruby-node">&quot;ACTION #{message}&quot;</span>,<span class="ruby-value str">&quot;emote&quot;</span>)
        <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000012" class="method-detail">
        <a name="M000012"></a>

        <div class="method-heading">
          <a href="#M000012" class="method-signature">
          <span class="method-name">handle_invite</span><span class="method-args">(channel)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Handles INVITEs
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000012-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000012-source">
<pre>
<span class="ruby-comment cmt"># File marcobot.rb, line 296</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">handle_invite</span>(<span class="ruby-identifier">channel</span>)
                <span class="ruby-comment cmt">#TODO: call for logs</span>
<span class="ruby-comment cmt">#               if invited == @nick then</span>
                        <span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;JOIN #{channel}&quot;</span>)
<span class="ruby-comment cmt">#                       privmsg(channel,&quot;Hello #{channel}!&quot;)</span>
<span class="ruby-comment cmt">#               end</span>
<span class="ruby-comment cmt">#               log(channel,user,invited,&quot;invite&quot;)</span>
        <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000014" class="method-detail">
        <a name="M000014"></a>

        <div class="method-heading">
          <a href="#M000014" class="method-signature">
          <span class="method-name">handle_kick</span><span class="method-args">(kicker,kicked,channel,cause)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Handles kicking
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000014-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000014-source">
<pre>
<span class="ruby-comment cmt"># File marcobot.rb, line 311</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">handle_kick</span>(<span class="ruby-identifier">kicker</span>,<span class="ruby-identifier">kicked</span>,<span class="ruby-identifier">channel</span>,<span class="ruby-identifier">cause</span>)
                <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">kicked</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@configfile</span>[<span class="ruby-value str">'nick'</span>] <span class="ruby-keyword kw">then</span>
                        <span class="ruby-identifier">send</span> <span class="ruby-node">&quot;JOIN #{channel}&quot;</span>
                        <span class="ruby-identifier">emote</span>(<span class="ruby-identifier">channel</span>,<span class="ruby-node">&quot;kicks #{kicker.split(&quot;!&quot;)[0]} in the face&quot;</span>)
                <span class="ruby-keyword kw">else</span>
                        <span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;NAMES #{channel}&quot;</span>)
                <span class="ruby-keyword kw">end</span>
                <span class="ruby-identifier">log</span>(<span class="ruby-identifier">channel</span>,<span class="ruby-identifier">kicker</span>,<span class="ruby-node">&quot;#{kicked}\n#{cause}&quot;</span>,<span class="ruby-value str">&quot;kick&quot;</span>)
        <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000011" class="method-detail">
        <a name="M000011"></a>

        <div class="method-heading">
          <a href="#M000011" class="method-signature">
          <span class="method-name">handle_message</span><span class="method-args">(user,target,message,usermask,frombot)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Handles incoming PRIVMSGs
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000011-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000011-source">
<pre>
<span class="ruby-comment cmt"># File marcobot.rb, line 242</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">handle_message</span>(<span class="ruby-identifier">user</span>,<span class="ruby-identifier">target</span>,<span class="ruby-identifier">message</span>,<span class="ruby-identifier">usermask</span>,<span class="ruby-identifier">frombot</span>)
                <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">target</span>[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;#&quot;</span> <span class="ruby-keyword kw">then</span>
                        <span class="ruby-identifier">puts</span> <span class="ruby-identifier">user</span>
                        <span class="ruby-identifier">puts</span> <span class="ruby-identifier">target</span>
                        <span class="ruby-identifier">puts</span> <span class="ruby-identifier">message</span>
                        <span class="ruby-identifier">puts</span> <span class="ruby-identifier">usermask</span>
                        <span class="ruby-comment cmt"># Stuff that is happening in a chan</span>
                        <span class="ruby-identifier">check_for_karma</span>(<span class="ruby-identifier">message</span>.<span class="ruby-identifier">strip</span>,<span class="ruby-identifier">usermask</span>,<span class="ruby-identifier">target</span>)
                        <span class="ruby-identifier">check_for_macro</span>(<span class="ruby-identifier">message</span>,<span class="ruby-identifier">target</span>,<span class="ruby-identifier">user</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@configfile</span>[<span class="ruby-value str">'macrosenabled'</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">'true'</span> <span class="ruby-keyword kw">and</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@configfile</span>[<span class="ruby-value str">'nomacrochans'</span>].<span class="ruby-identifier">downcase</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;,&quot;</span>).<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">target</span>.<span class="ruby-identifier">downcase</span>) <span class="ruby-keyword kw">and</span> <span class="ruby-operator">!</span><span class="ruby-identifier">message</span>.<span class="ruby-identifier">start_with?</span>(<span class="ruby-node">&quot;#{@configfile['commandidentifier']}macrocheck&quot;</span>)
                        <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@configfile</span>[<span class="ruby-value str">'botfuckery'</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">'true'</span> <span class="ruby-keyword kw">then</span>
                                <span class="ruby-identifier">check_for_command</span>(<span class="ruby-identifier">message</span>,<span class="ruby-identifier">target</span>,<span class="ruby-identifier">user</span>,<span class="ruby-identifier">usermask</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">user</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@configfile</span>[<span class="ruby-value str">'otherbot'</span>] <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">frombot</span>
                        <span class="ruby-keyword kw">else</span>
                                <span class="ruby-identifier">check_for_command</span>(<span class="ruby-identifier">message</span>,<span class="ruby-identifier">target</span>,<span class="ruby-identifier">user</span>,<span class="ruby-identifier">usermask</span>)
                        <span class="ruby-keyword kw">end</span>
                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">message</span>.<span class="ruby-identifier">start_with?</span>(<span class="ruby-ivar">@configfile</span>[<span class="ruby-value str">'specialcommandidentifier'</span>]) <span class="ruby-keyword kw">and</span> <span class="ruby-ivar">@configfile</span>[<span class="ruby-value str">'botfuckery'</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">'true'</span> <span class="ruby-keyword kw">then</span>
                                <span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;PRIVMSG #{@configfile['otherbot']} :!botprocessthis PRIVMSG #{target} :#{message}&quot;</span>)
                        <span class="ruby-keyword kw">end</span>
                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">message</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-value str">&quot;ACTION &quot;</span>,<span class="ruby-value str">&quot;&quot;</span>) <span class="ruby-operator">==</span> <span class="ruby-identifier">message</span> <span class="ruby-keyword kw">then</span>
                                <span class="ruby-identifier">log</span>(<span class="ruby-identifier">target</span>,<span class="ruby-identifier">user</span>,<span class="ruby-identifier">message</span>,<span class="ruby-value str">&quot;privmsg&quot;</span>)
                        <span class="ruby-keyword kw">else</span>
                                <span class="ruby-identifier">log</span>(<span class="ruby-identifier">target</span>,<span class="ruby-identifier">user</span>,<span class="ruby-identifier">message</span>,<span class="ruby-value str">&quot;emote&quot;</span>)
                                <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">message</span>.<span class="ruby-identifier">start_with?</span>(<span class="ruby-value str">&quot;ACTION rolls &quot;</span>) <span class="ruby-keyword kw">then</span>
                                        <span class="ruby-identifier">dieroll</span>(<span class="ruby-identifier">target</span>,<span class="ruby-identifier">message</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-value str">&quot;ACTION rolls &quot;</span>,<span class="ruby-value str">&quot;&quot;</span>).<span class="ruby-identifier">sub</span>(<span class="ruby-value str">&quot;&quot;</span>,<span class="ruby-value str">&quot;&quot;</span>))
                                <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">message</span>.<span class="ruby-identifier">start_with?</span>(<span class="ruby-value str">&quot;ACTION flips a coin&quot;</span>) <span class="ruby-keyword kw">then</span>
                                        <span class="ruby-identifier">coinflip</span>(<span class="ruby-identifier">target</span>)
                                <span class="ruby-keyword kw">end</span>
                        <span class="ruby-keyword kw">end</span>
                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">message</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">start_with?</span>(<span class="ruby-node">&quot;#{@configfile['nick']}: &quot;</span>) <span class="ruby-keyword kw">then</span>
                                <span class="ruby-identifier">decide</span>(<span class="ruby-identifier">target</span>,<span class="ruby-identifier">message</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-node">&quot;#{@configfile['nick']}: &quot;</span>,<span class="ruby-value str">&quot;&quot;</span>))
                        <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">message</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">start_with?</span>(<span class="ruby-node">&quot;#{@configfile['nick']}, &quot;</span>)
                                <span class="ruby-identifier">decide</span>(<span class="ruby-identifier">target</span>,<span class="ruby-identifier">message</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-node">&quot;#{@configfile['nick']}, &quot;</span>,<span class="ruby-value str">&quot;&quot;</span>))
                        <span class="ruby-keyword kw">end</span>
                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">message</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">start_with?</span>(<span class="ruby-value str">&quot;A:&quot;</span>) <span class="ruby-keyword kw">and</span> <span class="ruby-ivar">@trivia_started</span>[<span class="ruby-identifier">target</span>.<span class="ruby-identifier">downcase</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">then</span>
                                <span class="ruby-identifier">check_trivia_answer</span>(<span class="ruby-identifier">target</span>,<span class="ruby-identifier">message</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-value str">&quot;A:&quot;</span>,<span class="ruby-value str">&quot;&quot;</span>),<span class="ruby-identifier">user</span>)
                        <span class="ruby-keyword kw">end</span>
                <span class="ruby-keyword kw">else</span>
                        <span class="ruby-comment cmt"># Stuff in a PM.</span>
                        <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@configfile</span>[<span class="ruby-value str">'botfuckery'</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">'true'</span> <span class="ruby-keyword kw">then</span>
                                <span class="ruby-identifier">check_for_command</span>(<span class="ruby-identifier">message</span>,<span class="ruby-identifier">target</span>,<span class="ruby-identifier">user</span>,<span class="ruby-identifier">usermask</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">user</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@configfile</span>[<span class="ruby-value str">'otherbot'</span>] <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">frombot</span>
                        <span class="ruby-keyword kw">else</span>
                                <span class="ruby-identifier">check_for_command</span>(<span class="ruby-identifier">message</span>,<span class="ruby-identifier">target</span>,<span class="ruby-identifier">user</span>,<span class="ruby-identifier">usermask</span>)
                        <span class="ruby-keyword kw">end</span>
                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">message</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-value str">&quot;ACTION &quot;</span>,<span class="ruby-value str">&quot;&quot;</span>) <span class="ruby-operator">==</span> <span class="ruby-identifier">message</span> <span class="ruby-keyword kw">then</span>
                                <span class="ruby-identifier">log</span>(<span class="ruby-identifier">user</span>,<span class="ruby-identifier">user</span>,<span class="ruby-identifier">message</span>,<span class="ruby-value str">&quot;privmsg&quot;</span>)
                        <span class="ruby-keyword kw">else</span>
                                <span class="ruby-identifier">log</span>(<span class="ruby-identifier">user</span>,<span class="ruby-identifier">user</span>,<span class="ruby-identifier">message</span>,<span class="ruby-value str">&quot;emote&quot;</span>)
                        <span class="ruby-keyword kw">end</span>
                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">message</span>.<span class="ruby-identifier">start_with?</span>(<span class="ruby-ivar">@configfile</span>[<span class="ruby-value str">'specialcommandidentifier'</span>]) <span class="ruby-keyword kw">and</span> <span class="ruby-ivar">@configfile</span>[<span class="ruby-value str">'botfuckery'</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">'true'</span> <span class="ruby-keyword kw">then</span>
                                <span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;PRIVMSG #{@configfile['otherbot']} :!botprocessthis PRIVMSG #{user} :#{message}&quot;</span>)
                        <span class="ruby-keyword kw">end</span>
                <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000008" class="method-detail">
        <a name="M000008"></a>

        <div class="method-heading">
          <a href="#M000008" class="method-signature">
          <span class="method-name">handle_queue</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Handles the message queue
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000008-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000008-source">
<pre>
<span class="ruby-comment cmt"># File marcobot.rb, line 208</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">handle_queue</span>()
                <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@message_queue</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-keyword kw">then</span>
                        <span class="ruby-identifier">message</span> = <span class="ruby-ivar">@message_queue</span>[<span class="ruby-value">0</span>]
                        <span class="ruby-ivar">@message_queue</span>.<span class="ruby-identifier">delete</span> <span class="ruby-identifier">message</span>
                        <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">message</span>[<span class="ruby-value">2</span>]
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value">0</span>
                                        <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;High-priority message&quot;</span>
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value">1</span>
                                        <span class="ruby-identifier">sleep</span> <span class="ruby-value">0</span><span class="ruby-value">.8</span>
                                <span class="ruby-keyword kw">else</span>
                                        <span class="ruby-identifier">sleep</span> <span class="ruby-value">2</span>
                        <span class="ruby-keyword kw">end</span>
                        <span class="ruby-identifier">send_message</span>(<span class="ruby-identifier">message</span>[<span class="ruby-value">0</span>],<span class="ruby-identifier">message</span>[<span class="ruby-value">1</span>])
                <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000006" class="method-detail">
        <a name="M000006"></a>

        <div class="method-heading">
          <a href="#M000006" class="method-signature">
          <span class="method-name">handle_server_input</span><span class="method-args">(s,frombot=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Handles the input, passing it to the appropriate functions
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000006-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000006-source">
<pre>
<span class="ruby-comment cmt"># File marcobot.rb, line 98</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">handle_server_input</span>(<span class="ruby-identifier">s</span>,<span class="ruby-identifier">frombot</span>=<span class="ruby-keyword kw">nil</span>)
                <span class="ruby-identifier">s</span> = <span class="ruby-identifier">s</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">chomp</span>
                <span class="ruby-identifier">s_spaces</span> = <span class="ruby-identifier">s</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-value str">&quot;:&quot;</span>,<span class="ruby-value str">&quot;&quot;</span>).<span class="ruby-identifier">split</span>
                <span class="ruby-identifier">s_colons</span> = <span class="ruby-identifier">s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;:&quot;</span>)
                <span class="ruby-identifier">message</span> = <span class="ruby-identifier">s_colons</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;:&quot;</span>).<span class="ruby-identifier">sub</span>(<span class="ruby-identifier">s_colons</span>[<span class="ruby-value">1</span>],<span class="ruby-value str">&quot;&quot;</span>).<span class="ruby-identifier">sub</span>(<span class="ruby-value str">&quot;::&quot;</span>,<span class="ruby-value str">&quot;&quot;</span>)
                <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;PING&quot;</span> <span class="ruby-keyword kw">then</span>
                        <span class="ruby-identifier">send</span> <span class="ruby-value str">&quot;PONG &quot;</span><span class="ruby-operator">+</span><span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">sub</span>(<span class="ruby-value str">&quot;:&quot;</span>,<span class="ruby-value str">&quot;&quot;</span>)
                <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;PRIVMSG&quot;</span> <span class="ruby-keyword kw">then</span>
                        <span class="ruby-identifier">user</span> = <span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">sub</span>(<span class="ruby-value str">&quot;:&quot;</span>,<span class="ruby-value str">&quot;&quot;</span>).<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;!&quot;</span>)[<span class="ruby-value">0</span>]
                        <span class="ruby-identifier">target</span> = <span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">2</span>]
                        <span class="ruby-identifier">message</span> = <span class="ruby-identifier">s_colons</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;:&quot;</span>).<span class="ruby-identifier">sub</span>(<span class="ruby-identifier">s_colons</span>[<span class="ruby-value">1</span>],<span class="ruby-value str">&quot;&quot;</span>).<span class="ruby-identifier">sub</span>(<span class="ruby-value str">&quot;::&quot;</span>,<span class="ruby-value str">&quot;&quot;</span>)
                        <span class="ruby-identifier">handle_message</span>(<span class="ruby-identifier">user</span>,<span class="ruby-identifier">target</span>,<span class="ruby-identifier">message</span>,<span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">sub</span>(<span class="ruby-value str">&quot;:&quot;</span>,<span class="ruby-value str">&quot;&quot;</span>),<span class="ruby-identifier">frombot</span>)
                <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;INVITE&quot;</span> <span class="ruby-keyword kw">then</span>
                        <span class="ruby-identifier">handle_invite</span>(<span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">3</span>])
                <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;TOPIC&quot;</span> <span class="ruby-keyword kw">then</span>
                        <span class="ruby-identifier">handle_topic</span>(<span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">0</span>],<span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">2</span>],<span class="ruby-identifier">s_colons</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;:&quot;</span>).<span class="ruby-identifier">sub</span>(<span class="ruby-identifier">s_colons</span>[<span class="ruby-value">1</span>],<span class="ruby-value str">&quot;&quot;</span>).<span class="ruby-identifier">sub</span>(<span class="ruby-value str">&quot;::&quot;</span>,<span class="ruby-value str">&quot;&quot;</span>))
                <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;KICK&quot;</span> <span class="ruby-keyword kw">then</span>
                        <span class="ruby-identifier">handle_kick</span>(<span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">0</span>],<span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">3</span>],<span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">sub</span>(<span class="ruby-value str">&quot;:&quot;</span>,<span class="ruby-value str">&quot;&quot;</span>),<span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">4</span>])
                        <span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;NAMES #{s_spaces[2].sub(&quot;:&quot;,&quot;&quot;)}&quot;</span>)
                <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">s</span> <span class="ruby-operator">==</span> <span class="ruby-node">&quot;:#{@nick} MODE #{@nick} :+wx&quot;</span> <span class="ruby-keyword kw">then</span>
                        <span class="ruby-identifier">startup_routine</span>()
                <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;MODE&quot;</span> <span class="ruby-keyword kw">then</span>
                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">4</span>] <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">then</span>
                                <span class="ruby-identifier">log</span>(<span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">2</span>],<span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">0</span>],<span class="ruby-node">&quot;#{s_spaces[3]} #{s_spaces[4]}&quot;</span>,<span class="ruby-value str">&quot;usermode&quot;</span>)
                                <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">4</span>].<span class="ruby-identifier">strip</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@configfile</span>[<span class="ruby-value str">'nick'</span>] <span class="ruby-keyword kw">then</span>
<span class="ruby-comment cmt">#                                       @chanmodes[s_spaces[2].strip.downcase] = s_spaces[3].strip</span>
                                <span class="ruby-keyword kw">end</span>
                        <span class="ruby-keyword kw">else</span>
                                <span class="ruby-identifier">log</span>(<span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">2</span>],<span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">0</span>],<span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">3</span>],<span class="ruby-value str">&quot;chanmode&quot;</span>)
                        <span class="ruby-keyword kw">end</span>
                <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;PART&quot;</span> <span class="ruby-keyword kw">then</span>
                        <span class="ruby-identifier">log</span>(<span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">2</span>],<span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">0</span>],<span class="ruby-identifier">message</span>,<span class="ruby-value str">&quot;part&quot;</span>)
                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;!&quot;</span>)[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-ivar">@nick</span> <span class="ruby-keyword kw">then</span>
                                <span class="ruby-ivar">@channel</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">downcase</span>)
                        <span class="ruby-keyword kw">end</span>
                        <span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;NAMES #{s_spaces[2].sub(&quot;:&quot;,&quot;&quot;)}&quot;</span>)
                <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;JOIN&quot;</span> <span class="ruby-keyword kw">then</span>
                        <span class="ruby-identifier">log</span>(<span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">sub</span>(<span class="ruby-value str">&quot;:&quot;</span>,<span class="ruby-value str">&quot;&quot;</span>),<span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">0</span>],<span class="ruby-value str">&quot;&quot;</span>,<span class="ruby-value str">&quot;join&quot;</span>)
                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;!&quot;</span>)[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-ivar">@nick</span> <span class="ruby-keyword kw">then</span>
                                <span class="ruby-ivar">@channel</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">sub</span>(<span class="ruby-value str">&quot;:&quot;</span>,<span class="ruby-value str">&quot;&quot;</span>).<span class="ruby-identifier">downcase</span>)
<span class="ruby-comment cmt">#                               privmsg(s_spaces[2].sub(&quot;:&quot;,&quot;&quot;),&quot;Hello #{s_spaces[2].sub(&quot;:&quot;,&quot;&quot;)} people!&quot;)</span>
                                <span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;NAMES #{s_spaces[2].sub(&quot;:&quot;,&quot;&quot;)}&quot;</span>)
                        <span class="ruby-keyword kw">else</span>
                                <span class="ruby-identifier">autoop</span>(<span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">sub</span>(<span class="ruby-value str">&quot;:&quot;</span>,<span class="ruby-value str">&quot;&quot;</span>),<span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;!&quot;</span>)[<span class="ruby-value">0</span>]) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@channel</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">sub</span>(<span class="ruby-value str">&quot;:&quot;</span>,<span class="ruby-value str">&quot;&quot;</span>).<span class="ruby-identifier">downcase</span>) <span class="ruby-comment cmt"># Auto-op nicks</span>
                        <span class="ruby-keyword kw">end</span>
                <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;QUIT&quot;</span> <span class="ruby-keyword kw">then</span>
                        <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">channel</span> <span class="ruby-keyword kw">in</span> <span class="ruby-ivar">@channel</span>
                                <span class="ruby-identifier">log</span>(<span class="ruby-identifier">channel</span>,<span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">2</span>],<span class="ruby-identifier">message</span>,<span class="ruby-value str">&quot;quit&quot;</span>)
                        <span class="ruby-keyword kw">end</span>
                <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;NICK&quot;</span> <span class="ruby-keyword kw">then</span>
                        <span class="ruby-identifier">newnick</span> = <span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">sub</span>(<span class="ruby-value str">&quot;:&quot;</span>,<span class="ruby-value str">&quot;&quot;</span>).<span class="ruby-identifier">strip</span>
                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;!&quot;</span>)[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-ivar">@nick</span> <span class="ruby-keyword kw">then</span>
<span class="ruby-comment cmt">#                               newnick = s_spaces[2].sub(&quot;:&quot;,&quot;&quot;).strip</span>
                                <span class="ruby-ivar">@nick</span> = <span class="ruby-identifier">newnick</span>
                        <span class="ruby-keyword kw">end</span>
                        <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">channel</span> <span class="ruby-keyword kw">in</span> <span class="ruby-ivar">@channel</span>
                                <span class="ruby-identifier">log</span>(<span class="ruby-identifier">channel</span>,<span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">0</span>],<span class="ruby-identifier">newnick</span>,<span class="ruby-value str">&quot;nick&quot;</span>)
                        <span class="ruby-keyword kw">end</span>
                        
                <span class="ruby-keyword kw">end</span>
                <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">s</span>.<span class="ruby-identifier">start_with?</span>(<span class="ruby-node">&quot;:#{@server}&quot;</span>) <span class="ruby-keyword kw">then</span>
                        <span class="ruby-identifier">log</span>(<span class="ruby-value str">&quot;Network&quot;</span>,<span class="ruby-ivar">@server</span>,<span class="ruby-identifier">s</span>.<span class="ruby-identifier">strip</span>,<span class="ruby-value str">&quot;network&quot;</span>)
                        <span class="ruby-comment cmt"># Server message time! :naos.foonetic.net 353 NieXS @ #FaiD :</span>
<span class="ruby-comment cmt">#                       puts &quot;Network message: #{s}&quot;</span>
                        <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">1</span>]
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;353&quot;</span> <span class="ruby-comment cmt"># NAMES list</span>
                                        <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;recieving NAMES list&quot;</span>
                                        <span class="ruby-identifier">userlist</span> = <span class="ruby-identifier">s_spaces</span>
                                        <span class="ruby-identifier">userlist</span> = <span class="ruby-identifier">userlist</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot; &quot;</span>)
                                        <span class="ruby-identifier">userlist</span> = <span class="ruby-identifier">userlist</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-node">&quot;#{s_spaces[0]} #{s_spaces[1]} #{s_spaces[2]} #{s_spaces[3]} #{s_spaces[4]} &quot;</span>,<span class="ruby-value str">&quot;&quot;</span>)
                                        <span class="ruby-identifier">rawuserlist</span> = <span class="ruby-identifier">userlist</span>.<span class="ruby-identifier">downcase</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-value str">&quot;:&quot;</span>,<span class="ruby-value str">&quot;&quot;</span>).<span class="ruby-identifier">split</span>
                                        <span class="ruby-identifier">userlist</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp re">/(\+|%|@|&amp;|:)/</span>,<span class="ruby-value str">&quot;&quot;</span>)
                                        <span class="ruby-identifier">userlist</span> = <span class="ruby-identifier">userlist</span>.<span class="ruby-identifier">downcase</span>.<span class="ruby-identifier">split</span>
                                        <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@users</span>[<span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">4</span>].<span class="ruby-identifier">downcase</span>].<span class="ruby-identifier">frozen?</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@rawusers</span>[<span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">4</span>].<span class="ruby-identifier">downcase</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">then</span>
                                                <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;Clearing list&quot;</span>
                                                <span class="ruby-ivar">@users</span>[<span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">4</span>].<span class="ruby-identifier">downcase</span>] = []
                                                <span class="ruby-ivar">@rawusers</span>[<span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">4</span>].<span class="ruby-identifier">downcase</span>] = []
                                        <span class="ruby-keyword kw">end</span>
                                        <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;Appending list&quot;</span>
                                        <span class="ruby-ivar">@users</span>[<span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">4</span>].<span class="ruby-identifier">downcase</span>] = <span class="ruby-ivar">@users</span>[<span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">4</span>].<span class="ruby-identifier">downcase</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">userlist</span>
                                        <span class="ruby-ivar">@rawusers</span>[<span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">4</span>].<span class="ruby-identifier">downcase</span>] = <span class="ruby-ivar">@rawusers</span>[<span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">4</span>].<span class="ruby-identifier">downcase</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">rawuserlist</span>
                                        
                                        <span class="ruby-identifier">puts</span> <span class="ruby-identifier">userlist</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;, &quot;</span>)
                                <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;366&quot;</span> <span class="ruby-comment cmt"># EONAMES</span>
                                        <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;Locking #{s_spaces[3].downcase}'s userlist&quot;</span>
                                        <span class="ruby-ivar">@users</span>[<span class="ruby-identifier">s_spaces</span>[<span class="ruby-value">3</span>].<span class="ruby-identifier">downcase</span>].<span class="ruby-identifier">freeze</span>
<span class="ruby-comment cmt">#                                       @notrecievingnames[s_spaces[3].downcase] == true # Wrongly named vars ftl</span>
                        <span class="ruby-keyword kw">end</span>
                <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000013" class="method-detail">
        <a name="M000013"></a>

        <div class="method-heading">
          <a href="#M000013" class="method-signature">
          <span class="method-name">handle_topic</span><span class="method-args">(user,channel,newtopic)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Handles topic changes
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000013-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000013-source">
<pre>
<span class="ruby-comment cmt"># File marcobot.rb, line 306</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">handle_topic</span>(<span class="ruby-identifier">user</span>,<span class="ruby-identifier">channel</span>,<span class="ruby-identifier">newtopic</span>)
                <span class="ruby-identifier">log</span>(<span class="ruby-identifier">channel</span>,<span class="ruby-identifier">user</span>,<span class="ruby-identifier">newtopic</span>,<span class="ruby-value str">&quot;topic&quot;</span>)
        <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000020" class="method-detail">
        <a name="M000020"></a>

        <div class="method-heading">
          <a href="#M000020" class="method-signature">
          <span class="method-name">is_auth_user?</span><span class="method-args">(user)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Checks for authentication
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000020-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000020-source">
<pre>
<span class="ruby-comment cmt"># File marcobot.rb, line 419</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">is_auth_user?</span>(<span class="ruby-identifier">user</span>)
                <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@configfile</span>[<span class="ruby-value str">'authnicks'</span>].<span class="ruby-identifier">downcase</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;,&quot;</span>).<span class="ruby-identifier">member?</span>(<span class="ruby-identifier">user</span>.<span class="ruby-identifier">downcase</span>) <span class="ruby-keyword kw">then</span>
                        <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span>
                <span class="ruby-keyword kw">else</span>
                        <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span>
                <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000019" class="method-detail">
        <a name="M000019"></a>

        <div class="method-heading">
          <a href="#M000019" class="method-signature">
          <span class="method-name">log</span><span class="method-args">(target,user,message,command)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Logging, because my mind said so
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000019-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000019-source">
<pre>
<span class="ruby-comment cmt"># File marcobot.rb, line 363</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">log</span>(<span class="ruby-identifier">target</span>,<span class="ruby-identifier">user</span>,<span class="ruby-identifier">message</span>,<span class="ruby-identifier">command</span>)
                <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">target</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">then</span>
                <span class="ruby-identifier">filepath</span> = <span class="ruby-node">&quot;/var/log/marcobot/logs/#{target.sub(&quot;:&quot;,&quot;&quot;).strip}-#{Time.new.day}-#{Time.new.month}-#{Time.new.year}&quot;</span>.<span class="ruby-identifier">downcase</span>
                <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">filepath</span>) <span class="ruby-keyword kw">then</span>
                        <span class="ruby-ivar">@logarray</span>[<span class="ruby-identifier">filepath</span>] = <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">filepath</span>,<span class="ruby-value str">&quot;a&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@logarray</span>[<span class="ruby-identifier">filepath</span>].<span class="ruby-identifier">class</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">File</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@logarray</span>[<span class="ruby-identifier">filepath</span>].<span class="ruby-identifier">closed?</span>
                <span class="ruby-keyword kw">else</span>
                        <span class="ruby-ivar">@logarray</span>[<span class="ruby-identifier">filepath</span>] = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">filepath</span>,<span class="ruby-value str">&quot;a&quot;</span>)
                <span class="ruby-keyword kw">end</span>
                <span class="ruby-keyword kw">begin</span>
                <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">command</span>
                        <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;privmsg&quot;</span>
                                <span class="ruby-identifier">time</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">new</span>
                                <span class="ruby-ivar">@logarray</span>[<span class="ruby-identifier">filepath</span>].<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;#{timestamp(Time.new)} &lt;#{user}&gt; #{message.gsub(&quot;\n&quot;,&quot;&quot;)}&quot;</span>
                        <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;emote&quot;</span>
                                <span class="ruby-identifier">time</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">new</span>
                                <span class="ruby-identifier">message</span> = <span class="ruby-identifier">message</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-value str">&quot;ACTION &quot;</span>,<span class="ruby-value str">&quot;&quot;</span>)
                                <span class="ruby-identifier">message</span> = <span class="ruby-identifier">message</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-value str">&quot;&quot;</span>,<span class="ruby-value str">&quot;&quot;</span>)
                                <span class="ruby-ivar">@logarray</span>[<span class="ruby-identifier">filepath</span>].<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;#{timestamp(Time.new)} ***#{user} #{message.gsub(&quot;\n&quot;,&quot;&quot;)}&quot;</span>
                        <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;invite&quot;</span>
                                <span class="ruby-identifier">time</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">new</span>
                                <span class="ruby-ivar">@logarray</span>[<span class="ruby-identifier">filepath</span>].<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;#{timestamp(Time.new)} ***#{user} has invited #{message} into #{target}.&quot;</span>
                        <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;topic&quot;</span>
                                <span class="ruby-identifier">time</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">new</span>
                                <span class="ruby-ivar">@logarray</span>[<span class="ruby-identifier">filepath</span>].<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;#{timestamp(Time.new)} ***#{user} has changed the topic to: #{message}&quot;</span>
                        <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;part&quot;</span>
                                <span class="ruby-identifier">time</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">new</span>
                                <span class="ruby-ivar">@logarray</span>[<span class="ruby-identifier">filepath</span>].<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;#{timestamp(Time.new)} ***#{user.split(&quot;!&quot;)[0]} (#{user}) has left #{target} (#{message})&quot;</span>
                        <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;join&quot;</span>
                                <span class="ruby-identifier">time</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">new</span>
                                <span class="ruby-ivar">@logarray</span>[<span class="ruby-identifier">filepath</span>].<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;#{timestamp(Time.new)} ***#{user.split(&quot;!&quot;)[0]} (#{user}) has joined #{target}&quot;</span>
                        <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;chanmode&quot;</span>
                                <span class="ruby-identifier">time</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">new</span>
                                <span class="ruby-ivar">@logarray</span>[<span class="ruby-identifier">filepath</span>].<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;#{timestamp(Time.new)} ***#{user} has changed the channel mode: #{message}&quot;</span>
                        <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;usermode&quot;</span>
                                <span class="ruby-identifier">time</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">new</span>
                                <span class="ruby-ivar">@logarray</span>[<span class="ruby-identifier">filepath</span>].<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;#{timestamp(Time.new)} ***#{user} has changed #{message.split(&quot; &quot;)[1]}'s mode: #{message.split(&quot; &quot;)[0]}&quot;</span>
                        <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;quit&quot;</span>
                                <span class="ruby-identifier">time</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">new</span>
                                <span class="ruby-ivar">@logarray</span>[<span class="ruby-identifier">filepath</span>].<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;#{timestamp(Time.new)} ***#{user.split(&quot;!&quot;)[0] unless user.class == NilClass} (#{user}) has left IRC: #{message}&quot;</span>
                        <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;kick&quot;</span>
                                <span class="ruby-identifier">time</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">new</span>
                                <span class="ruby-ivar">@logarray</span>[<span class="ruby-identifier">filepath</span>].<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;#{timestamp(Time.new)} ***#{user} has kicked #{message.split(&quot;\n&quot;)[0]} from #{target} (#{message.split(&quot;\n&quot;)[1]})&quot;</span>
                        <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;network&quot;</span>
                                <span class="ruby-identifier">time</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">new</span>
                                <span class="ruby-ivar">@logarray</span>[<span class="ruby-identifier">filepath</span>].<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;#{timestamp(Time.new)} #{message}&quot;</span>
                        <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;nick&quot;</span>
                                <span class="ruby-ivar">@logarray</span>[<span class="ruby-identifier">filepath</span>].<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;#{timestamp(Time.new)} ***#{user} is now known as #{message}.&quot;</span>
                                
                <span class="ruby-keyword kw">end</span>
                <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Exception</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">detail</span>
                        <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-node">&quot;Oh dear, an exception: #{detail.message()}&quot;</span>)
                <span class="ruby-keyword kw">end</span>
                <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000007" class="method-detail">
        <a name="M000007"></a>

        <div class="method-heading">
          <a href="#M000007" class="method-signature">
          <span class="method-name">main_loop</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Looping and looping and looping again&#8230;
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000007-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000007-source">
<pre>
<span class="ruby-comment cmt"># File marcobot.rb, line 190</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">main_loop</span>()
                <span class="ruby-keyword kw">while</span> <span class="ruby-ivar">@connected</span>
                        <span class="ruby-identifier">ready</span> = <span class="ruby-identifier">select</span>([<span class="ruby-ivar">@irc</span>],<span class="ruby-keyword kw">nil</span>,<span class="ruby-keyword kw">nil</span>,<span class="ruby-value">0</span><span class="ruby-value">.1</span>)
                        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ready</span> <span class="ruby-keyword kw">then</span>
                                <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@irc</span>.<span class="ruby-identifier">eof</span>
                                <span class="ruby-identifier">s</span> = <span class="ruby-ivar">@irc</span>.<span class="ruby-identifier">gets</span>
                                <span class="ruby-identifier">rawlog</span>(<span class="ruby-identifier">s</span>)
                                <span class="ruby-identifier">puts</span> <span class="ruby-identifier">s</span>
                                <span class="ruby-identifier">handle_server_input</span>(<span class="ruby-identifier">s</span>)
                        <span class="ruby-keyword kw">end</span>
                        <span class="ruby-identifier">handle_queue</span>()
                        <span class="ruby-keyword kw">while</span> (<span class="ruby-constant">Gtk</span>.<span class="ruby-identifier">events_pending?</span>)
                                <span class="ruby-constant">Gtk</span>.<span class="ruby-identifier">main_iteration</span>
                        <span class="ruby-keyword kw">end</span>
                <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000016" class="method-detail">
        <a name="M000016"></a>

        <div class="method-heading">
          <a href="#M000016" class="method-signature">
          <span class="method-name">privmsg</span><span class="method-args">(target,message,priority = 1)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Adds a message to the queue
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000016-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000016-source">
<pre>
<span class="ruby-comment cmt"># File marcobot.rb, line 335</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-identifier">message</span>,<span class="ruby-identifier">priority</span> = <span class="ruby-value">1</span>)
                <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">message</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">400</span> <span class="ruby-keyword kw">then</span>
                        <span class="ruby-identifier">message_split</span> = <span class="ruby-identifier">message</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-regexp re">/.{1,400}/</span>)
                        <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">message</span> <span class="ruby-keyword kw">in</span> <span class="ruby-identifier">message_split</span>
                                <span class="ruby-ivar">@message_queue</span>.<span class="ruby-identifier">push</span>([<span class="ruby-identifier">target</span>,<span class="ruby-identifier">message</span>,<span class="ruby-identifier">priority</span>])
                        <span class="ruby-keyword kw">end</span>
                <span class="ruby-keyword kw">else</span>
                        <span class="ruby-ivar">@message_queue</span>.<span class="ruby-identifier">push</span>([<span class="ruby-identifier">target</span>,<span class="ruby-identifier">message</span>,<span class="ruby-identifier">priority</span>])
                <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000009" class="method-detail">
        <a name="M000009"></a>

        <div class="method-heading">
          <a href="#M000009" class="method-signature">
          <span class="method-name">rawlog</span><span class="method-args">(s)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Basic logging
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000009-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000009-source">
<pre>
<span class="ruby-comment cmt"># File marcobot.rb, line 225</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">rawlog</span>(<span class="ruby-identifier">s</span>)
<span class="ruby-comment cmt">#               puts &quot;#{timestamp(Time.new)} #{s}&quot; </span>
                <span class="ruby-ivar">@rawlogfile</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-value str">&quot;/var/log/marcobot/rawlog&quot;</span>,<span class="ruby-value str">&quot;a+&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@rawlogfile</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">File</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@rawlogfile</span>.<span class="ruby-identifier">closed?</span>
                <span class="ruby-ivar">@rawlogfile</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-node">&quot;#{timestamp(Time.new)}&gt; #{s}&quot;</span>)
                
        <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000003" class="method-detail">
        <a name="M000003"></a>

        <div class="method-heading">
          <a href="#M000003" class="method-signature">
          <span class="method-name">send</span><span class="method-args">(message)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
sends stuff through the socket
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000003-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000003-source">
<pre>
<span class="ruby-comment cmt"># File marcobot.rb, line 75</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">send</span>(<span class="ruby-identifier">message</span>)
                <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;#{timestamp(Time.new)} --&gt; #{message}&quot;</span>
                <span class="ruby-ivar">@irc</span>.<span class="ruby-identifier">send</span> <span class="ruby-node">&quot;#{message}\n&quot;</span>,<span class="ruby-value">0</span>
                <span class="ruby-identifier">rawlog</span>(<span class="ruby-node">&quot;--&gt; #{message}&quot;</span>)
        <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000017" class="method-detail">
        <a name="M000017"></a>

        <div class="method-heading">
          <a href="#M000017" class="method-signature">
          <span class="method-name">send_message</span><span class="method-args">(target,message)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sends a message bypassing the queue. Should only be used by <a
href="IRCBot.html#M000008">handle_queue</a>()
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000017-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000017-source">
<pre>
<span class="ruby-comment cmt"># File marcobot.rb, line 347</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">send_message</span>(<span class="ruby-identifier">target</span>,<span class="ruby-identifier">message</span>)
                <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@configfile</span>[<span class="ruby-value str">'botfuckery'</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;true&quot;</span>
                        <span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;PRIVMSG #{@configfile['targetbot']} :!botprocessed PRIVMSG #{target} :#{message}&quot;</span>)
                <span class="ruby-keyword kw">else</span>
                        <span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;PRIVMSG #{target} :#{message}&quot;</span>)
                <span class="ruby-keyword kw">end</span>
                <span class="ruby-identifier">log</span>(<span class="ruby-identifier">target</span>,<span class="ruby-ivar">@configfile</span>[<span class="ruby-value str">'nick'</span>],<span class="ruby-identifier">message</span>,<span class="ruby-value str">&quot;privmsg&quot;</span>)
        <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000015" class="method-detail">
        <a name="M000015"></a>

        <div class="method-heading">
          <a href="#M000015" class="method-signature">
          <span class="method-name">startup_routine</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
What to do when you should do something which I forget now oh gods halp
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000015-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000015-source">
<pre>
<span class="ruby-comment cmt"># File marcobot.rb, line 322</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">startup_routine</span>()          
                <span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;MODE #{@configfile['nick']} +TB&quot;</span>)
                <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@configfile</span>[<span class="ruby-value str">'debugmode'</span>] <span class="ruby-operator">!=</span> <span class="ruby-value str">'yes'</span> <span class="ruby-keyword kw">then</span>
                        <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">channel</span> <span class="ruby-keyword kw">in</span> <span class="ruby-ivar">@channel</span>
                                <span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;JOIN #{channel}&quot;</span>)
                        <span class="ruby-keyword kw">end</span>
                <span class="ruby-keyword kw">else</span>
                        <span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;JOIN #{@configfile['debugchannel']}&quot;</span>)
                <span class="ruby-keyword kw">end</span>
                <span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;PRIVMSG NickServ :IDENTIFY #{@ns_password}&quot;</span>)
        <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000010" class="method-detail">
        <a name="M000010"></a>

        <div class="method-heading">
          <a href="#M000010" class="method-signature">
          <span class="method-name">timestamp</span><span class="method-args">(time)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Cute timestamps
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000010-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000010-source">
<pre>
<span class="ruby-comment cmt"># File marcobot.rb, line 233</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">timestamp</span>(<span class="ruby-identifier">time</span>) <span class="ruby-comment cmt"># Pretty timestamps!</span>
                <span class="ruby-identifier">hour</span> = (<span class="ruby-identifier">time</span>.<span class="ruby-identifier">hour</span><span class="ruby-operator">&lt;</span><span class="ruby-value">10</span> <span class="ruby-operator">?</span> <span class="ruby-value str">&quot;0&quot;</span><span class="ruby-operator">+</span><span class="ruby-identifier">time</span>.<span class="ruby-identifier">hour</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">time</span>.<span class="ruby-identifier">hour</span>)
                <span class="ruby-identifier">minute</span> = (<span class="ruby-identifier">time</span>.<span class="ruby-identifier">min</span><span class="ruby-operator">&lt;</span><span class="ruby-value">10</span> <span class="ruby-operator">?</span> <span class="ruby-value str">&quot;0&quot;</span><span class="ruby-operator">+</span><span class="ruby-identifier">time</span>.<span class="ruby-identifier">min</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">time</span>.<span class="ruby-identifier">min</span>)
                <span class="ruby-identifier">second</span> = (<span class="ruby-identifier">time</span>.<span class="ruby-identifier">sec</span><span class="ruby-operator">&lt;</span><span class="ruby-value">10</span> <span class="ruby-operator">?</span> <span class="ruby-value str">&quot;0&quot;</span><span class="ruby-operator">+</span><span class="ruby-identifier">time</span>.<span class="ruby-identifier">min</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">time</span>.<span class="ruby-identifier">sec</span>)
                <span class="ruby-identifier">thetime</span> = <span class="ruby-node">&quot;[#{hour}:#{minute}:#{second}]&quot;</span>
                <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">thetime</span>
        <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000028" class="method-detail">
        <a name="M000028"></a>

        <div class="method-heading">
          <a href="#M000028" class="method-signature">
          <span class="method-name">trivia_init</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000028-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000028-source">
<pre>
<span class="ruby-comment cmt"># File marcobot.rb, line 1035</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">trivia_init</span>()
                <span class="ruby-ivar">@trivia_questions</span> = <span class="ruby-constant">YAML</span><span class="ruby-operator">::</span><span class="ruby-identifier">load</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-node">&quot;#{@basepath}trivia&quot;</span>))
                <span class="ruby-ivar">@trivia_questions</span>=<span class="ruby-ivar">@trivia_questions</span>.<span class="ruby-identifier">sort_by</span> { <span class="ruby-identifier">rand</span> }
        <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000029" class="method-detail">
        <a name="M000029"></a>

        <div class="method-heading">
          <a href="#M000029" class="method-signature">
          <span class="method-name">trivia_question</span><span class="method-args">(target)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000029-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000029-source">
<pre>
<span class="ruby-comment cmt"># File marcobot.rb, line 1039</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">trivia_question</span>(<span class="ruby-identifier">target</span>)
                <span class="ruby-identifier">target</span> = <span class="ruby-identifier">target</span>.<span class="ruby-identifier">downcase</span>
                <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@old_trivia_question</span>[<span class="ruby-identifier">target</span>.<span class="ruby-identifier">downcase</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">then</span>
                        <span class="ruby-ivar">@old_trivia_question</span>[<span class="ruby-identifier">target</span>] = []
                <span class="ruby-keyword kw">end</span>
                <span class="ruby-identifier">has_new_questions</span> = <span class="ruby-keyword kw">false</span>
                <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">question</span> <span class="ruby-keyword kw">in</span> <span class="ruby-ivar">@trivia_questions</span>
                        <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@old_trivia_question</span>[<span class="ruby-identifier">target</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">question</span>) <span class="ruby-keyword kw">then</span>
                                <span class="ruby-identifier">has_new_questions</span> = <span class="ruby-keyword kw">true</span>
                                <span class="ruby-ivar">@trivia_question</span>[<span class="ruby-identifier">target</span>] = <span class="ruby-identifier">question</span>
                        <span class="ruby-keyword kw">end</span>
                <span class="ruby-keyword kw">end</span>
                <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">has_new_questions</span> <span class="ruby-keyword kw">then</span>
                        <span class="ruby-ivar">@old_trivia_question</span>[<span class="ruby-identifier">target</span>].<span class="ruby-identifier">push</span> <span class="ruby-ivar">@trivia_question</span>[<span class="ruby-identifier">target</span>]
                        <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-node">&quot;Q: #{@trivia_question[target.downcase].split(&quot;\n&quot;)[0]}&quot;</span>)     
                <span class="ruby-keyword kw">else</span>
                        <span class="ruby-identifier">privmsg</span>(<span class="ruby-identifier">target</span>,<span class="ruby-value str">&quot;No more questions :(&quot;</span>)
                        <span class="ruby-ivar">@trivia_started</span>[<span class="ruby-identifier">target</span>] = <span class="ruby-keyword kw">false</span>
                        <span class="ruby-ivar">@trivia_questions</span>=<span class="ruby-ivar">@trivia_questions</span>.<span class="ruby-identifier">sort_by</span> { <span class="ruby-identifier">rand</span> }
                <span class="ruby-keyword kw">end</span>           
        <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>